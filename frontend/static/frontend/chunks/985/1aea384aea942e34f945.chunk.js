"use strict";(self.webpackChunksgp=self.webpackChunksgp||[]).push([[985],{46985:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Re});n(47941),n(82526),n(38880),n(89554),n(54747),n(49337),n(33321),n(47042),n(43371),n(79753),n(41817),n(32165),n(66992),n(78783),n(33948),n(68309),n(91038),n(88674),n(19601),n(35666),n(74916),n(15306),n(27207),n(92222),n(34553),n(26699),n(32023),n(57327),n(41539),n(69070);var r,a,l=n(67294),o=n(85458),i=n(27484),c=n.n(i),u=n(42705),d=n.n(u),f=n(42919),s=n(23455),m=n(84636),p=n(63386),y=n(10438),v=n(58043),g=n(52110),h=n(96579),E=n(5368),b=n(7171),S=n(55902),w=n(2306),x=n(40120),O=n(71577),_=n(60881),D=n(19650),F=n(12028),P=n(88999),C=n(16114),T=n(41003),A=n(60331),I=n(89366),N=n(76570),M=n(57254),R=n(8812),Z=n(78338),j=n(25592),k=n(15873),U=(n(65069),n(23123),n(23157),n(33161),n(9653),n(54678),n(21249),n(14277));function L(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var H=o.ZP.div(r||(r=L(["\n    display = flex;\n    flex-direction = column;\n    flex = 1;\n"]))),z=o.ZP.div(a||(a=L(["\n    display = flex;\n    flex-direction = column;\n    flex = 1;\n"]))),B=function(e){var t=e.item,n=e.idx,r=e.render,a=e.style;return l.createElement(z,{style:a},r(t,n))},V=function(e){var t=e.dataSource,n=(e.onRemove,e.onUpdate,e.render),r=e.style,a=e.listItemStyle;return l.createElement(H,{style:r},0===t.length&&l.createElement(U.Z,{image:U.Z.PRESENTED_IMAGE_SIMPLE,description:"Sem Dados"}),t.map((function(e,t){return l.createElement(B,{key:"li-".concat(t),item:e,idx:t,render:n,style:a})})))};V.ItemHeader=function(e){var t=e.left,n=void 0===t?l.createElement(l.Fragment,null):t,r=e.right,a=void 0===r?l.createElement(l.Fragment,null):r,o=e.leftStyle,i=void 0===o?{}:o,c=e.rightStyle,u=void 0===c?{}:c;return l.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},l.createElement("div",{style:i},n),l.createElement("div",{style:u},a))},V.ItemContent=function(e){var t=e.children;return l.createElement("div",null,t)},V.ItemFooter=function(e){var t=e.left,n=void 0===t?l.createElement(l.Fragment,null):t,r=e.right,a=void 0===r?l.createElement(l.Fragment,null):r;return l.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},l.createElement("div",null,n),l.createElement("div",null,a))};const W=V;var K,Q=n(60678),G=n(26402),Y=n(32787),$=n(73218),q=n(96974);function J(e,t,n,r,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function X(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ae(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw l}}}}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw a}}return l}(e,t)||ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oe,ie,ce=(0,o.ZP)(Y.Z)(K||(oe=["\n    .ant-input{\n        text-align: right;\n    }\n    .ant-input-group-addon{\n        background: #f5f5f5;\n    }\n"],ie||(ie=oe.slice(0)),K=Object.freeze(Object.defineProperties(oe,{raw:{value:Object.freeze(ie)}})))),ue=function(e){return"".concat(e.SOHNUM_0,"_").concat(e.ITMREF_0)},de=function(e){var t=e.item,n=e.index,r=e.formData,a=e.onFormDataChange,o=ue(t);return l.createElement(l.Fragment,null,o in r&&l.createElement("div",{style:{display:"flex",flexDirection:"row"}},l.createElement(ce,{id:"core-".concat(n),style:{width:90,marginRight:"2px"},suffix:l.createElement("b",null,"''"),addonBefore:"Core",maxLength:1,onChange:function(e){return a(e,t)},value:r[o].core}),l.createElement(ce,{id:"width-".concat(n),style:{width:100,marginRight:"2px"},suffix:l.createElement("b",null,"mm"),addonBefore:"L",maxLength:4,onChange:function(e){return a(e,t)},value:r[o].width}),l.createElement(ce,{id:"diam-".concat(n),style:{width:100,marginRight:"2px"},suffix:l.createElement("b",null,"mm"),addonBefore:"⌀",maxLength:4,onChange:function(e){return a(e,t)},value:r[o].diam}),l.createElement(ce,{id:"gram-".concat(n),style:{width:90,marginRight:"2px"},suffix:l.createElement("b",null,"gsm"),addonBefore:"G",maxLength:3,onChange:function(e){return a(e,t)},value:r[o].gram})))},fe=function(e){var t=e.item,n=e.index,r=e.formData,a=e.onFormDataChange;return l.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"space-between"}},l.createElement("div",{style:{marginRight:"10px"}},l.createElement("div",{style:{color:"#0050b3",fontSize:"16px",lineHeight:"24px",fontWeight:600}},t.BPCNAM_0),l.createElement("div",{style:{fontSize:"14px",lineHeight:"22px",fontWeight:500}},t.ITMREF_0),l.createElement("div",{style:{fontWeight:400}},t.ITMDES1_0),l.createElement(de,{item:t,index:n,formData:r,onFormDataChange:a})),l.createElement("div",{style:{alignSelf:"flex-end"}},l.createElement("div",{style:{color:"#8c8c8c",fontSize:"12px",lineHeight:"20px",fontWeight:400}},"Encomenda"),l.createElement("div",{style:{fontSize:"14px",lineHeight:"22px",fontWeight:500}},t.SOHNUM_0),l.createElement("div",{style:{fontSize:"14px",lineHeight:"22px",fontWeight:400}},t.PRFNUM_0),l.createElement(ce,{disabled:!0,style:{width:120},suffix:l.createElement("b",null,"m",l.createElement("sup",null,"2")),addonBefore:"Qtd.",value:t.DSPTOTQTY_0/1e3})))},se=function(e){var t=e.removeItem;return l.createElement(Q.Z,{icon:l.createElement($.Z,{style:{color:"red"}}),onClick:function(){return t()}})};const me=function(e){var t=e.dataSource,n=e.setDataSource,r=(e.footerRef,e.closeParent),a=e.reloadDataTable,o=(0,q.s0)(),i=re((0,l.useState)({}),2),c=i[0],u=i[1],d=re((0,l.useState)({status:"none"}),2),m=d[0],p=d[1],y=function(e,t){var n=ue(e);if(n in c)t[n]=te({},c[n]);else{if(t[n]={qty:e.DSPTOTQTY_0/1e3,ITMREF_0:e.ITMREF_0,SOHNUM_0:e.SOHNUM_0,BPCORD_0:e.BPCORD_0,changed:!1,new:!1},e.id)return t[n].nw1=e.nw1,t[n].nw2=e.nw2,t[n].width=e.lar,t[n].formula=e.formu,t[n].diam=e.diam_ref,t[n].core=e.core,t[n].gram=e.gsm,void(t[n].gtin=e.gtin);var r=e.ITMDES1_0.split(" ").reverse();t[n].new=!0;var a,l=X(r);try{for(l.s();!(a=l.n()).done;){var o=a.value;"core"in t[n]||!o.includes("''")&&!o.includes("'")?"width"in t[n]||!o.toLowerCase().startsWith("l")?"diam"in t[n]||!o.toLowerCase().startsWith("d")?"gram"in t[n]||!(o.toLowerCase().startsWith("g")||!isNaN(o)&&Number.isInteger(parseFloat(o)))||(t[n].gram=o.toLowerCase().replaceAll("g","")):t[n].diam=o.toLowerCase().replaceAll("d",""):t[n].width=o.toLowerCase().replaceAll("l",""):t[n].core=o.replaceAll("'","")}}catch(e){l.e(e)}finally{l.f()}}};(0,l.useEffect)((function(){var e,n={},r=X(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;y(a,n)}}catch(e){r.e(e)}finally{r.f()}u(te({},n))}),[t]);var v=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.SD)({url:"".concat(s.T5,"/newordemfabrico/"),parameters:c});case 2:t=e.sent,p(t.data);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){J(l,r,a,o,i,"next",e)}function i(e){J(l,r,a,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}(),g=function(e,t){var n=ue(t),r=e.target.id.split("-")[0];u((function(t){var a;return te(te({},t),{},ne({},n,te(te({},t[n]),{},(ne(a={},r,e.target.value),ne(a,"changed",!0),a))))}))},E=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&a(),n([]),r()};return l.createElement(l.Fragment,null,l.createElement(G.Z,{result:m,successButtonOK:l.createElement(O.Z,{type:"primary",key:"goto-of",onClick:function(){o("/app/ordemfabrico/formdetails",{state:te({},m)})}},"Ir para Ordem de Fabrico"),successButtonClose:l.createElement(O.Z,{key:"goto-close",onClick:function(){return E(!0)}},"Fechar"),errorButtonOK:l.createElement(O.Z,{type:"primary",key:"goto-ok",onClick:function(){p({status:"none"})}},"OK"),errorButtonClose:l.createElement(O.Z,{key:"goto-close",onClick:E},"Fechar")},t.length>0&&l.createElement(h.Z,{center:l.createElement(O.Z,{block:!0,type:"primary",size:"small",onClick:v},"Registar")}),l.createElement(W,{dataSource:t,listItemStyle:{marginBottom:"20px",marginTop:"5px",paddingBottom:"5px",borderBottom:"solid 1px #f0f0f0"},render:function(e,r){return l.createElement(l.Fragment,null,l.createElement(W.ItemHeader,{leftStyle:{width:"100%",marginRight:"20px"},left:l.createElement(fe,{index:r,item:e,formData:c,onFormDataChange:g}),right:l.createElement(se,{removeItem:function(){return function(e){var r=t.filter((function(t){return t.ITMREF_0!==e.ITMREF_0||t.SOHNUM_0!==e.SOHNUM_0}));n(r)}(e)}})}))}})))};var pe;function ye(){return ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}function ve(e){return function(e){if(Array.isArray(e))return Se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t,n,r,a,l,o){try{var i=e[l](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function he(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){ge(l,r,a,o,i,"next",e)}function i(e){ge(l,r,a,o,i,"throw",e)}o(void 0)}))}}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);o=!0);}catch(e){i=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw a}}return l}(e,t)||be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){if(e){if("string"==typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}x.Z.Option;var _e=O.Z.Group,De=_.Z.Title,Fe=function(e){var t=e.form,n=e.dataAPI,r=e.groupByOrder,a=e.setGroupByOrder,o=e.setFlyoutStatus,i=e.flyoutStatus,c=e.ordemFabricoStatusField,u=l.createElement(l.Fragment,null,l.createElement(O.Z,{type:"primary",size:"small",disabled:!!i.visible,onClick:function(){return o((function(e){return xe(xe({},e),{},{visible:!e.visible})}))}},"Nova Ordem de Fabrico")),d=l.createElement(D.Z,null,l.createElement("div",{style:{display:"flex",flexDirection:"row",whiteSpace:"nowrap"}},l.createElement("div",null,"Agrupar por Encomenda: "),l.createElement("div",null,l.createElement(F.Z,{size:"small",checked:r,onClick:function(){n.clearSort(),n.addParameters({groupByOrder:!r}),n.first(),n.fetchPost(),n.clearData(),a((function(e){return!e}))}}))),l.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap"}},l.createElement("div",null,"Ordem de Fabrico: Estado "),l.createElement("div",null,l.createElement(v.ZP,{noStyle:!0,visible:!0,form:t},l.createElement(v.gN,{noStyle:!0,name:"ofstatus",initialValue:"all",noLabel:!0},c())))));return l.createElement(h.Z,{left:u,right:d})},Pe=l.createElement(P.Z,null,l.createElement(P.Z.Item,{key:"1",icon:l.createElement(I.Z,null)},"1st menu item")),Ce=o.ZP.div(pe||(pe=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n    padding: 20px 80px; \n    background: #f0f0f0;\n    \n    .connector{\n        position: absolute;\n        top: -10px;\n        left: 60px;\n        height: 60px;\n        z-index: 999;\n        border-left: 2px dotted #8c8c8c;\n        border-bottom: 2px dotted #8c8c8c;\n        width: 25px;\n    }\n"]))),Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.form,n=e.dataAPI,r=e.setShowFilter,a=e.showFilter,o=e.ordemFabricoStatusField,i=(0,l.useState)({}),c=Ee(i,2),u=(c[0],c[1],(0,l.useState)(!1)),d=Ee(u,2),m=d[0],p=d[1],g=function(){var e=he(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.SD)({url:"".concat(s.T5,"/sellcustomerslookup/"),pagination:{limit:10},filter:Oe({},"fmulti_customer","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return n=e.sent,r=n.data.rows,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=he(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.SD)({url:"".concat(s.T5,"/sellorderslookup/"),pagination:{limit:10},filter:Oe({},"fmulti_order","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return n=e.sent,r=n.data.rows,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=he(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.SD)({url:"".concat(s.T5,"/sellitemslookup/"),pagination:{limit:10},filter:Oe({},"fmulti_item","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return n=e.sent,r=n.data.rows,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){return l.createElement(v.K1,{onChange:function(e,t){},handleSearch:h,keyField:"SOHNUM_0",valueField:"SOHNUM_0",labelField:function(e,t,n){return"".concat(e[n],"  -  ").concat(e.PRFNUM_0)},dropdownMatchSelectWidth:350,placeholder:"Nº Encomenda/Nº Proforma",allowClear:!0})},w=function(){return l.createElement(v.K1,{onChange:function(e,t){},handleSearch:g,keyField:"BPCNUM_0",valueField:"BPCNAM_0",labelField:function(e,t,n){return"".concat(e[n],"  -  ").concat(e[t])},dropdownMatchSelectWidth:350,placeholder:"Nº/Nome Cliente",allowClear:!0})},x=function(){return l.createElement(v.K1,{onChange:function(e,t){},handleSearch:E,keyField:"ITMREF_0",valueField:"ITMDES1_0",labelField:function(e,t,n){return"".concat(e[n],"  -  ").concat(e[t])},dropdownMatchSelectWidth:350,placeholder:"Cód/Designação Artigo",allowClear:!0})},_=function(e,t){var r,a;if("filter"===e){!m&&p(!0);var l=xe(xe({},t),{},{fmulti_customer:t.fmulti_customer&&""!==t.fmulti_customer.value?"%".concat(t.fmulti_customer.value.replaceAll(" ","%%"),"%"):void 0,fmulti_order:t.fmulti_order&&""!==t.fmulti_order.value?"%".concat(t.fmulti_order.value.replaceAll(" ","%%"),"%"):void 0,fmulti_item:t.fmulti_item&&""!==t.fmulti_item.value?"%".concat(t.fmulti_item.value.replaceAll(" ","%%"),"%"):void 0,LASDLVNUM_0:t.LASDLVNUM_0&&""!==t.LASDLVNUM_0?"%".concat(t.LASDLVNUM_0.replaceAll(" ","%%"),"%"):void 0,forderdate:(0,y.TK)(null===(r=t.forderdate)||void 0===r?void 0:r.formatted),SHIDAT_0:(0,y.TK)(null===(a=t.SHIDAT_0)||void 0===a?void 0:a.formatted)});n.addFilters(l),n.first(),n.fetchPost()}},D=function(e,r,a){if("filter"===e)"ofstatus"in r?(n.addFilters({ofstatus:r.ofstatus},!1),n.first(),n.fetchPost()):t.setFieldsValue(a)};return l.createElement(l.Fragment,null,l.createElement(v.fS,{schema:Ie({form:t,ordersField:S,customersField:w,itemsField:x,ordemFabricoStatusField:o}),filterRules:Ae(),form:t,width:350,setShowFilter:r,showFilter:a}),l.createElement(v.ZP,{visible:!0,form:t,name:"feature-form-1",layout:"horizontal",onFinish:function(e){return _("filter",e)},onValuesChange:function(e,t){return D("filter",e,t)},style:{minWidth:"40vw"},rowGap:"10px",field:{layout:"vertical",gap:"5px",overflow:!1,labelStyle:{align:"left"},alert:{position:"right",visible:!0}},fieldSet:{wide:4,layout:"horizontal",overflow:!1,grow:!1,alert:{position:"bottom",visible:!0}}},l.createElement(v.C3,{wide:5},l.createElement(v.gN,{name:"fmulti_order",initialValue:{key:"",value:"",label:""},noLabel:!0},S())),l.createElement(v.C3,null,l.createElement(v.gN,{name:"fmulti_customer",initialValue:{key:"",value:"",label:""},noLabel:!0},w())),l.createElement(v.C3,{wide:5},l.createElement(v.gN,{name:"forderdate",noLabel:!0},l.createElement(v.P,null))),l.createElement(v.C3,{wide:2,style:{alignItems:"flex-end",justifyContent:"flex-start"}},l.createElement(_e,null,l.createElement(O.Z,{style:{padding:"3px"},onClick:function(){return t.submit()}},l.createElement(N.Z,null)),l.createElement(O.Z,{style:{padding:"3px"}},l.createElement(b.Z,{style:{fontSize:"16px",marginTop:"2px"},onClick:function(){return r((function(e){return!e}))}})),l.createElement(C.Z,{overlay:Pe},l.createElement(O.Z,{style:{padding:"3px"}},l.createElement(M.Z,null)))))))},Ae=function(e){return(0,p.J1)({fmulti_item:d().string().label("Cód/Designação Artigo")},e).unknown(!0)},Ie=function(e){return[{fmulti_order:{label:"Nº Encomenda/Nº Proforma",field:e.ordersField}},{fmulti_customer:{label:"Nº/Nome de Cliente",field:e.customersField}},{forderdate:{label:"Data Encomenda",field:{type:"rangedate"}}},{fmulti_item:{label:"Cód/Designação Artigo",field:e.itemsField,initialValue:{key:"",value:"",label:""}}},{SHIDAT_0:{label:"Data Expedição",field:{type:"rangedate"}}},{LASDLVNUM_0:{label:"Nº Última Expedição"}},{ofstatus:{label:"Ordem de Fabrico: Estado",field:e.ordemFabricoStatusField,ignoreFilterTag:function(e){return"all"===e}}}]},Ne=function(e){var t=e.record,n=Ee((0,l.useState)([]),2),r=n[0],a=n[1],o=(0,m.E)({payload:{url:"".concat(s.T5,"/sellorderitemsList/"),pagination:{enabled:!1},filter:{SOHNUM_0:t.SOHNUM_0},sort:[]}}),i=(0,g.B)({dataAPI:o,data:o.getData().rows,uuid:"items",include:{SOHNUM_0:{title:"Nº Encomenda"},ITMREF_0:{title:"Cod. Artigo",optional:!1,width:180},ORIQTY_0:{title:"Quantidade Original",optional:!1,width:180},QTY_0:{title:"Quantidade",optional:!1,width:120},ITMDES1_0:{title:"Designação",optional:!1},TSICOD_2:{title:"Gramagem",optional:!1,width:100},TSICOD_3:{title:"Largura",optional:!1,width:100},SDHNUM_0:{title:"Nº Expedição",optional:!1,width:150}},exclude:["SOHNUM_0"]});return(0,l.useEffect)((function(){o.first(),o.fetchPost()}),[]),l.createElement(l.Fragment,null,o.hasData()&&l.createElement(Ce,null,l.createElement("div",{className:"connector"}),l.createElement(g.Z,{header:!1,columnChooser:!1,reload:!0,size:"small",selection:{enabled:!0,rowKey:function(e){return e.ITMREF_0},onSelection:a,multiple:!0,selectedRows:r,setSelectedRows:a},dataAPI:o,columns:i,onFetch:o.fetchPost,scroll:{y:400,scrollToFirstRowOnChange:!0}})))},Me=function(e){return l.createElement(Ne,{record:e})};const Re=function(){var e=Ee((0,l.useState)([]),2),t=e[0],n=e[1],r=Ee((0,l.useState)(!1),2),a=r[0],o=r[1],i=Ee((0,l.useState)([]),2),u=i[0],d=i[1],f=Ee(T.Z.useForm(),1)[0],p=Ee((0,l.useState)(!1),2),y=p[0],h=p[1],b=(0,m.E)({payload:{url:"".concat(s.T5,"/sellorders/"),parameters:{groupByOrder:y},pagination:{enabled:!0,page:1,pageSize:15},filter:{},sort:[{column:"SOHNUM_0",direction:"DESC",order:"descend",table:"enc"}]}}),x=document.getElementById("filter-tags"),_=Ee((0,l.useState)({visible:!1,fullscreen:!1}),2),D=_[0],F=_[1],P=Ee((0,l.useState)([]),2),C=P[0],I=P[1],N=(0,l.useRef)();(0,l.useEffect)((function(){b.first(),b.fetchPost()}),[]);var M,U=(0,g.B)({dataAPI:b,data:b.getData().rows,uuid:"sorders",include:xe(xe(xe(xe({},(M={table:"itm",idx:0,optional:!1},xe({},!y&&{ITMREF_0:xe({title:"Cód. Artigo",width:"160px",render:function(e){return l.createElement("b",null,e)},style:{background:"red"}},M),ITMDES1_0:xe({title:"Designação Artigo",width:"350px",render:function(e){return l.createElement("div",{style:{width:"340px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"11px"}},e)}},M)}))),function(e){return{SOHNUM_0:xe({title:"Nº Encomenda",width:"160px",render:function(e){return l.createElement("b",null,e)}},e),PRFNUM_0:xe({title:"Nº Fatura Proforma",width:"160px"},e),ORDDAT_0:xe({title:"Data Encomenda",width:"160px",render:function(e){return c()(e).format(s.zT)}},e),BPCNAM_0:xe({title:"Nome Cliente",width:"20%",render:function(e){return l.createElement("div",{style:{whiteSpace:"nowrap"}},l.createElement("b",null,e))}},e)}}({table:"enc",idx:1,optional:!1})),function(e){return{BPCORD_0:xe({title:"Nº Cliente"},e),SHIDAT_0:xe({title:"Data Expedição",visible:!0,render:function(e){return c()(e).format(s.zT)}},e),DEMDLVDAT_0:xe({title:"Data Expedição Solicitada",render:function(e){return c()(e).format(s.zT)}},e),CUSORDREF_0:xe({title:"Ref. Encomenda Cliente",visible:!0},e),DAYLTI_0:xe({title:"Prazo Entrega (Dias)",visible:!0},e),LASDLVDAT_0:xe({title:"Data Última Expedição",render:function(e){return c()(e).format(s.zT)}},e),LASDLVNUM_0:xe({title:"Nº Última Expedição"},e),LASINVDAT_0:xe({title:"Data Última Fatura",render:function(e){return c()(e).format(s.zT)}},e),LASINVNUM_0:xe({title:"Nº Última Fatura"},e),DSPTOTQTY_0:xe({title:"Quantidade Acumulada"},e),DSPTOTVOL_0:xe({title:"Volume Acumulado"},e),DSPTOTWEI_0:xe({title:"Peso Acumulado"},e),DSPVOU_0:xe({title:"Unidade Volume"},e),DSPWEU_0:xe({title:"Unidade Peso"},e),CREUSR_0:xe({title:"Operador Criação"},e),CREDAT_0:xe({title:"Data Criação",render:function(e){return c()(e).format(s.zT)}},e),CREDATTIM_0:xe({title:"Data/Hora Criação",render:function(e){return c()(e).format(s.Cu)}},e),UPDUSR_0:xe({title:"Operador Modificação"},e),UPDDAT_0:xe({title:"Data Modificação",render:function(e){return c()(e).format(s.zT)}},e),UPDDATTIM_0:xe({title:"Data/Hora Modificação",render:function(e){return c()(e).format(s.Cu)}},e)}}({table:"enc"})),{},{ACTION:{width:"40px",title:"",sort:!1,optional:!1,idx:999,render:function(e,t){return l.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},!L(t)&&D.visible&&l.createElement(O.Z,{style:{marginRight:"8px"},size:"small",icon:l.createElement(R.Z,null),onClick:function(){return H(t)}}),0===t.status&&l.createElement(A.Z,{icon:l.createElement(Z.Z,null),color:"default"}),1===t.status&&l.createElement(A.Z,{icon:l.createElement(j.Z,{spin:!0}),color:"processing"}),99===t.status&&l.createElement(A.Z,{icon:l.createElement(k.Z,null),color:"success"}))}}}),exclude:[]}),L=function(e){return!(!e.ordemfabrico_id&&-1===C.findIndex((function(t){return t.SOHNUM_0==e.SOHNUM_0&&t.ITMREF_0==e.ITMREF_0})))},H=function(e){L(e)||I((function(t){return[].concat(ve(t),[xe({},e)])}))},z=function(){return l.createElement(v.mg,{keyField:"value",valueField:"label",style:{width:150},options:[{value:"all",label:"Todos"},{value:"notcreated",label:"Não Criada"},{value:"inpreparation",label:"Em Preparação"},{value:"inprogress",label:"Em Progresso"},{value:"finished",label:"Finalizada"}]})};return l.createElement(l.Fragment,null,l.createElement(S.Z,{flyoutWidth:"700px",flyoutStatus:D,style:{height:"100vh"}},l.createElement(S.Z.content,null,l.createElement(Fe,{form:f,dataAPI:b,groupByOrder:y,setGroupByOrder:h,setFlyoutStatus:F,flyoutStatus:D,ordemFabricoStatusField:z}),x&&l.createElement(E.Z,{elId:x},l.createElement(v.WH,{form:f,filters:b.getAllFilter(),schema:Ie,rules:Ae()})),l.createElement(g.Z,ye({title:l.createElement(De,{level:4},"Encomendas"),columnChooser:!0,reload:!0,size:"small",toolbar:l.createElement(Te,{form:f,dataAPI:b,setShowFilter:o,showFilter:a,ordemFabricoStatusField:z}),selection:{enabled:!1,rowKey:function(e){return y?e.SOHNUM_0:"".concat(e.SOHNUM_0,"-").concat(e.ITMREF_0,"-").concat(e.SOPLIN_0)},onSelection:n,multiple:!0,selectedRows:t,setSelectedRows:n}},y&&{expandable:{expandedRowRender:Me},onExpand:function(e,t){return function(e,t){d(e?[t]:[])}(e,t.SOHNUM_0)},expandedRowKeys:u},{paginationProps:{pageSizeOptions:[10,15,20,30]},dataAPI:b,columns:U,onFetch:b.fetchPost}))),l.createElement(S.Z.flyout,null,l.createElement(w.Z.Header,{fullScreen:!1,setStatus:F,left:l.createElement(De,{level:4,style:{marginBottom:"0px"}},"Nova Ordem de Fabrico")}),l.createElement(w.Z.Body,null,l.createElement(me,{dataSource:C,setDataSource:I,footerRef:N,closeParent:function(){F((function(e){return xe(xe({},e),{},{visible:!1})}))},reloadDataTable:b.fetchPost})))))}}}]);