{"version":3,"file":"chunks/308/de7a66a416e579421cb4.chunk.js","mappings":"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","sources":["webpack://sgp/./src/pages/planeamento/formulacao/FormFormulacaoUpsert.jsx","webpack://sgp/./src/pages/planeamento/ordemFabrico/FormFormulacao.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback, useRef, useContext } from 'react';\r\nimport { createUseStyles } from 'react-jss';\r\nimport styled from 'styled-components';\r\nimport dayjs from 'dayjs';\r\nimport Joi from 'joi';\r\nimport { fetch, fetchPost } from \"utils/fetch\";\r\nimport { API_URL } from \"config\";\r\nimport { getSchema } from \"utils/schemaValidator\";\r\nimport { FormLayout, Field, FieldSet, FieldItem, AlertsContainer, Item, SelectField, CheckboxField, HorizontalRule, VerticalSpace, InputAddon, SelectDebounceField } from \"components/formLayout\";\r\nimport AlertMessages from \"components/alertMessages\";\r\nimport IconButton from \"components/iconButton\";\r\nimport ResultMessage from 'components/resultMessage';\r\nimport Portal from \"components/portal\";\r\nimport { Input, Space, Form, Button, InputNumber, DatePicker } from \"antd\";\r\nimport { PlusOutlined } from '@ant-design/icons';\r\nimport { MdAdjust, MdAssignmentReturned } from 'react-icons/md';\r\nimport { CgCloseO } from 'react-icons/cg';\r\nimport { DATE_FORMAT, DATETIME_FORMAT, FORMULACAO_EXTRUSORAS_COD, FORMULACAO_EXTRUSORAS_VAL, FORMULACAO_TOLERANCIA, FORMULACAO_PONDERACAO_EXTR, FORMULACAO_MANGUEIRAS } from 'config';\r\nimport { OFabricoContext } from '../ordemFabrico/FormOFabricoValidar';\r\n\r\nconst schema = (keys, excludeKeys) => {\r\n    return getSchema({\r\n        formu_materiasprimas_A: Joi.array().label(\"Matérias Primas da Extrusora A\").min(1).required(),\r\n        formu_materiasprimas_BC: Joi.array().label(\"Matérias Primas das Extrusoras B & C\").min(1).required(),\r\n        matprima_cod_A: Joi.string().label(\"Matéria Prima\").required(),\r\n        densidade_A: Joi.number().label(\"Densidade\").required(),\r\n        /* mangueira_A: Joi.string().label(\"Mangueira Extrusora A\").required(), */\r\n        arranque_A: Joi.number().label(\"Arranque\").required(),\r\n        matprima_cod_BC: Joi.string().label(\"Matéria Prima\").required(),\r\n        densidade_BC: Joi.number().label(\"Densidade\").required(),\r\n        arranque_BC: Joi.number().label(\"Arranque\").required()\r\n       /*  mangueira_BC: Joi.string().label(\"Mangueira Extrusora BC\").required() */\r\n    }, keys, excludeKeys).unknown(true);\r\n}\r\n\r\nconst setId = (id) => {\r\n    if (id) {\r\n        return { key: \"update\", values: { id } };\r\n    }\r\n    return { key: \"insert\", values: {} };\r\n}\r\n\r\nconst append = (value, suffix = '', prefix = '', onUndefined = '') => {\r\n    if (value) {\r\n        return `${prefix}${value}${suffix}`;\r\n    }\r\n    return onUndefined;\r\n}\r\n\r\nconst HeaderA = ({ backgroundColor = \"#f5f5f5\", color = \"#000\", border = \"solid 1px #d9d9d9\" }) => {\r\n    return (\r\n        <FieldSet wide={16} layout=\"horizontal\" margin={false}\r\n            style={{ backgroundColor: `${backgroundColor}`, color: `${color}`, fontWeight: 500, textAlign: \"center\" }}\r\n            field={{ noItemWrap: true, label: { enabled: false } }}\r\n        >\r\n            <FieldSet wide={7} margin={false}\r\n                field={{\r\n                    wide: [13, 3],\r\n                    style: { border, borderLeft: \"none\", alignSelf: \"stretch\", display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }\r\n                }}\r\n            >\r\n                <Field style={{ border, alignSelf: \"stretch\", display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }} >Matérias Primas</Field>\r\n                <Field >Densidade</Field>\r\n            </FieldSet>\r\n            <FieldSet margin={false} wide={9} layout=\"vertical\"\r\n                field={{ style: { border, borderLeft: \"none\" } }}\r\n            >\r\n                <FieldSet field={{ wide: [16] }} margin={false}>\r\n                    <Field>Distribuição por Extrusora</Field>\r\n                </FieldSet>\r\n                <FieldSet margin={false}\r\n                    field={{\r\n                        wide: [/* 3,  */4, 4, 4, 3, 1/* , 2, 3 */],\r\n                        style: { fontSize: \"10px\", border, borderLeft: \"none\", borderTop: \"none\", fontWeight: 400 }\r\n                    }}\r\n                >\r\n                    {/* <Field>Doseador</Field> */}\r\n                    <Field>%A</Field>\r\n                    <Field>Arranque</Field>\r\n                    <Field>Tolerância</Field>\r\n                    <Field>% Global</Field>\r\n                    <Field></Field>\r\n                    {/* <Field>Checklist</Field>\r\n                    <Field>Data/Hora</Field> */}\r\n                </FieldSet>\r\n            </FieldSet>\r\n        </FieldSet>\r\n    );\r\n}\r\n\r\nconst HeaderBC = ({ backgroundColor = \"#f5f5f5\", color = \"#000\", border = \"solid 1px #d9d9d9\" }) => {\r\n    return (\r\n        <FieldSet wide={16} layout=\"horizontal\" margin={false}\r\n            field={{ noItemWrap: true, label: { enabled: false } }}\r\n            style={{ fontSize: \"10px\", backgroundColor: `${backgroundColor}`, color: `${color}`, textAlign: \"center\" }}\r\n        >\r\n            <FieldSet wide={7} margin={false}\r\n                field={{\r\n                    wide: [13, 3],\r\n                    style: { border, borderLeft: \"none\" }\r\n                }}\r\n            >\r\n                <Field style={{ border }}></Field>\r\n                <Field></Field>\r\n            </FieldSet>\r\n            <FieldSet margin={false} wide={9}>\r\n                <FieldSet margin={false}\r\n                    field={{\r\n                        wide: [/* 3,  */4, 4, 4, 3, 1/*  2, 3 */],\r\n                        label: { enabled: false },\r\n                        style: { border, borderLeft: \"none\" }\r\n                    }}\r\n                >\r\n                    {/* <Field>Doseador</Field> */}\r\n                    <Field>%B e C</Field>\r\n                    <Field>Arranque</Field>\r\n                    <Field>Tolerância</Field>\r\n                    <Field>% Global</Field>\r\n                    <Field></Field>\r\n                    {/* <Field>Checklist</Field>\r\n                    <Field>Data/Hora</Field> */}\r\n                </FieldSet>\r\n            </FieldSet>\r\n        </FieldSet>\r\n    );\r\n}\r\n\r\nconst updateGlobals = ({ values = {}, adjust = { extrusora: null, index: null }, action = \"adjust\" }) => {\r\n    const { formu_materiasprimas_A: listA = [], formu_materiasprimas_BC: listBC = [], ...rest } = values;\r\n    let ponderacaoA = FORMULACAO_PONDERACAO_EXTR[0];\r\n    let ponderacaoBC = FORMULACAO_PONDERACAO_EXTR[1];\r\n    let globalA = 0;\r\n    let globalBC = 0;\r\n    let sumArranqueA = 0;\r\n    let sumArranqueBC = 0;\r\n\r\n    for (let [i, v] of listA.entries()) {\r\n        let arranque = (v.arranque_A ? v.arranque_A : 0);\r\n        let global = (ponderacaoA * arranque) / 100;\r\n        if ((action === \"adjust\" && adjust.extrusora !== 'A') || (action !== 'adjust') || (action === \"adjust\" && adjust.index !== i && adjust.extrusora === 'A')) {\r\n            globalA += global;\r\n            sumArranqueA += arranque;\r\n        }\r\n        v.global = global;\r\n    }\r\n    for (let [i, v] of listBC.entries()) {\r\n        let arranque = (v.arranque_BC ? v.arranque_BC : 0);\r\n        let global = (ponderacaoBC * arranque) / 100;\r\n        if ((action === \"adjust\" && adjust.extrusora !== 'BC') || (action !== 'adjust') || (action === \"adjust\" && adjust.index !== i && adjust.extrusora === 'BC')) {\r\n            globalBC += global;\r\n            sumArranqueBC += arranque;\r\n        }\r\n        v.global = global;\r\n    }\r\n\r\n    if (action === \"adjust\") {\r\n        if (adjust.extrusora === 'A') {\r\n            listA[adjust.index].arranque_A = (100 - sumArranqueA) < 0 ? 0 : (100 - sumArranqueA);\r\n            listA[adjust.index].global = (ponderacaoA * (listA[adjust.index].arranque_A)) / 100;\r\n            globalA += listA[adjust.index].global;\r\n        } else {\r\n            listBC[adjust.index].arranque_BC = (100 - sumArranqueBC) < 0 ? 0 : (100 - sumArranqueBC);\r\n            listBC[adjust.index].global = (ponderacaoBC * (listBC[adjust.index].arranque_BC)) / 100;\r\n            globalBC += listBC[adjust.index].global;\r\n        }\r\n    }\r\n\r\n    return { ...rest, formu_materiasprimas_A: listA, formu_materiasprimas_BC: listBC, totalGlobal: (globalA + globalBC) };\r\n}\r\n\r\nconst SubFormMateriasPrimas = ({ form, forInput, name, matPrimasLookup, sum = false, border = \"solid 1px #d9d9d9\", id }) => {\r\n\r\n    const adjust = (idx, extrusora) => {\r\n        const fieldValues = updateGlobals({ values: form.getFieldsValue(true), adjust: { extrusora, index: idx }, action: \"adjust\" });\r\n        form.setFieldsValue(fieldValues);\r\n    }\r\n\r\n    return (\r\n        <Form.List name={name}>\r\n            {(fields, { add, remove, move }) => {\r\n\r\n                const addRow = (fields) => {\r\n                    add({ [`tolerancia_${id}`]: FORMULACAO_TOLERANCIA, removeCtrl: true });\r\n                    /* add({ item_id: 1, item_paletesize: '970x970', item_numbobines: 10 }, 0); */\r\n                }\r\n                const removeRow = (fieldName, field) => {\r\n                    remove(fieldName);\r\n                }\r\n                const moveRow = (from, to) => {\r\n                    move(from, to);\r\n                }\r\n\r\n                return (\r\n                    <>\r\n\r\n                        {fields.map((field, index) => (\r\n\r\n                            <FieldSet key={field.key} wide={16} layout=\"horizontal\" margin={false} field={{ label: { enabled: false } }}>\r\n                                <FieldSet wide={7} margin={false}\r\n                                    field={{\r\n                                        wide: [13, 3],\r\n                                        style: { border: \"solid 1px #fff\", borderLeft: \"none\", fontWeight: \"10px\" }\r\n                                    }}\r\n                                >\r\n{/*                                     <Field name={[field.name, `mangueira_${id}`]}>\r\n                                        <SelectField size=\"small\" data={FORMULACAO_MANGUEIRAS[id]} keyField=\"key\" textField=\"key\"\r\n                                            optionsRender={(d, keyField, textField) => ({ label: `${d[textField]}`, value: d[keyField] })}\r\n                                        />\r\n                                    </Field> */}\r\n                                    <Field name={[field.name, `matprima_cod_${id}`]}>\r\n                                        <SelectField size=\"small\" data={matPrimasLookup} keyField=\"ITMREF_0\" textField=\"ITMDES1_0\"\r\n                                            optionsRender={(d, keyField, textField) => ({ label: `${d[textField]}`, value: d[keyField] })}\r\n                                            showSearch\r\n                                            filterOption={(input, option) => option.label.toLowerCase().indexOf(input.toLowerCase()) >= 0}\r\n                                        />\r\n                                    </Field>\r\n                                    <Field name={[field.name, `densidade_${id}`]}><InputNumber controls={false} size=\"small\" min={0} max={50} precision={3} step={.025} /></Field>\r\n                                </FieldSet>\r\n                                <FieldSet margin={false} wide={9}>\r\n                                    <FieldSet margin={false}\r\n                                        field={{\r\n                                            wide: [/* 3,  */4, 4, 4, 3, 1/* , 2, 3 */],\r\n                                            label: { enabled: false },\r\n                                            style: { border: \"solid 1px #fff\", borderLeft: \"none\", borderTop: \"none\" }\r\n                                        }}\r\n                                    >\r\n                                        {/* <Field name={[field.name, \"doseador\"]}><Input size=\"small\" /></Field> */}\r\n                                        <Field></Field>\r\n                                        <Field name={[field.name, `arranque_${id}`]}><InputNumber size=\"small\" controls={false} {...(forInput && { addonBefore: <IconButton onClick={() => adjust(index, id)}><MdAdjust /></IconButton> })} addonAfter={<b>%</b>} precision={2} min={0} max={100} /></Field>\r\n                                        <Field name={[field.name, `tolerancia_${id}`]}><InputNumber size=\"small\" controls={false} addonBefore=\"&plusmn;\" addonAfter={<b>%</b>} maxLength={4} precision={1} min={0} max={100} /></Field>\r\n                                        <Field style={{ textAlign: \"center\", border: \"solid 1px #fff\", borderLeft: \"none\", borderTop: \"none\" }}>{append(form.getFieldValue([name, field.name, \"global\"])?.toFixed(2), '%')}{/* <InputNumber size=\"small\" addonAfter={<b>%</b>} maxLength={4} min={0} max={100} /> */}</Field>\r\n                                        <FieldItem label={{ enabled: false }}>{forInput && <IconButton onClick={() => removeRow(field.name, field)} style={{ alignSelf: \"center\" }}><CgCloseO /></IconButton>}</FieldItem>\r\n                                        {/*<Field name={[field.name, \"checklist\"]}><CheckboxField /></Field>\r\n                                        <Field name={[field.name, \"check_datetime\"]}><DatePicker /></Field> */}\r\n                                    </FieldSet>\r\n                                </FieldSet>\r\n                            </FieldSet>\r\n\r\n                        ))}\r\n                        {(sum && form.getFieldValue(\"totalGlobal\") > 0) &&\r\n                            <FieldSet wide={16} layout=\"horizontal\" margin={false} field={{ label: { enabled: false } }}>\r\n                                <FieldSet wide={7} margin={false} />\r\n                                <FieldSet margin={false} wide={9}>\r\n                                    <FieldSet margin={false}\r\n                                        field={{\r\n                                            wide: [12, 4],\r\n                                            label: { enabled: false },\r\n                                            style: { border: \"solid 1px #fff\", borderLeft: \"none\", borderTop: \"none\" }\r\n                                        }}\r\n                                    >\r\n                                        <Field></Field>\r\n                                        <Field style={{ marginTop: \"4px\", textAlign: \"center\", fontWeight: 500, border }}>{append(form.getFieldValue(\"totalGlobal\").toFixed(2), '%')}</Field>\r\n                                    </FieldSet>\r\n                                </FieldSet>\r\n                            </FieldSet>\r\n                        }\r\n                        <FieldSet>\r\n                            {forInput && <Button type=\"dashed\" onClick={() => addRow(fields)} style={{ width: \"100%\" }}><PlusOutlined />Adicionar</Button>}\r\n                        </FieldSet>\r\n                    </>\r\n                );\r\n            }}\r\n        </Form.List>\r\n    );\r\n}\r\n\r\n\r\n\r\nconst LoadMateriasPrimasLookup = async (record) => {\r\n    const { data: { rows } } = await fetchPost({ url: `${API_URL}/materiasprimaslookup/`, filter: {} });\r\n    return rows;\r\n}\r\nconst loadCustomersLookup = async (value) => {\r\n    const { data: { rows } } = await fetchPost({ url: `${API_URL}/sellcustomerslookup/`, pagination: { limit: 10 }, filter: { [\"fmulti_customer\"]: `%${value.replaceAll(' ', '%%')}%` } });\r\n    return rows;\r\n}\r\n\r\n\r\n\r\nexport default ({ record, setFormTitle, parentRef, closeParent, parentReload, wrapForm = \"form\", forInput = true }) => {\r\n    const ctx = useContext(OFabricoContext);\r\n    const [form] = Form.useForm();\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [changedValues, setChangedValues] = useState({});\r\n    const [formStatus, setFormStatus] = useState({ error: [], warning: [], info: [], success: [] });\r\n    const [guides, setGuides] = useState(false);\r\n    const [operation, setOperation] = useState(setId(record.formulacao_id));\r\n    const [resultMessage, setResultMessage] = useState({ status: \"none\" });\r\n    const [matPrimasLookup, setMatPrimasLookup] = useState([]);\r\n\r\n    const init = (lookup = false) => {\r\n        (async () => {\r\n            if (lookup) {\r\n                setMatPrimasLookup(await LoadMateriasPrimasLookup(record));\r\n            }\r\n            if (operation.key === \"update\") {\r\n                (setFormTitle) && setFormTitle({ title: `Editar Formulação` });\r\n                let formu_materiasprimas_A = record.formulacaoMatPrimas?.filter(v => (v.extrusora === 'A')).map(v => ({ global: v.vglobal, /* mangueira_A: v.mangueira, */ matprima_cod_A: v.matprima_cod, densidade_A: v.densidade, arranque_A: v.arranque, tolerancia_A: v.tolerancia, removeCtrl: true }));\r\n                let formu_materiasprimas_BC = record.formulacaoMatPrimas?.filter(v => (v.extrusora === 'BC')).map(v => ({ global: v.vglobal, /* mangueira_BC: v.mangueira, */ matprima_cod_BC: v.matprima_cod, densidade_BC: v.densidade, arranque_BC: v.arranque, tolerancia_BC: v.tolerancia, removeCtrl: true }));\r\n                form.setFieldsValue({ ...record.formulacao, formu_materiasprimas_A, formu_materiasprimas_BC, totalGlobal: 100 });\r\n            } else {\r\n                (setFormTitle) && setFormTitle({ title: `Nova Formulação ${ctx.item_cod}`, subTitle: `${ctx.item_nome}` });\r\n                form.setFieldsValue({\r\n                    extr0: FORMULACAO_EXTRUSORAS_COD[0], extr1: FORMULACAO_EXTRUSORAS_COD[1], extr2: FORMULACAO_EXTRUSORAS_COD[2], extr3: FORMULACAO_EXTRUSORAS_COD[3], extr4: FORMULACAO_EXTRUSORAS_COD[4],\r\n                    extr0_val: FORMULACAO_EXTRUSORAS_VAL[0], extr1_val: FORMULACAO_EXTRUSORAS_VAL[1], extr2_val: FORMULACAO_EXTRUSORAS_VAL[2], extr3_val: FORMULACAO_EXTRUSORAS_VAL[3], extr4_val: FORMULACAO_EXTRUSORAS_VAL[4]\r\n                });\r\n            }\r\n            setLoading(false);\r\n        })();\r\n    }\r\n\r\n    useEffect(() => {\r\n        init(true);\r\n        return (() => setMatPrimasLookup([]));\r\n    }, []);\r\n\r\n    const onValuesChange = (changedValues, { formu_materiasprimas_A: allA = [], formu_materiasprimas_BC: allBC = [], ...allValues }) => {\r\n        const formu_materiasprimas_A = allA.filter(v => v.removeCtrl === true);\r\n        const formu_materiasprimas_BC = allBC.filter(v => v.removeCtrl === true);\r\n        const fieldValues = updateGlobals({ values: { ...allValues, formu_materiasprimas_A, formu_materiasprimas_BC }, action: \"valueschange\" });\r\n        form.setFieldsValue(fieldValues);\r\n        setChangedValues(changedValues);\r\n    }\r\n\r\n    const onFinish = async (values) => {\r\n        const items = [];\r\n        const status = { error: [], warning: [], info: [], success: [] };\r\n        const msgKeys = [\"formu_materiasprimas_A\", \"formu_materiasprimas_BC\"];\r\n        const v = schema(false, [/* 'mangueira_A', */ 'matprima_cod_A', 'densidade_A', 'arranque_A', /* 'mangueira_BC', */ 'matprima_cod_BC', 'densidade_BC', 'arranque_BC']).validate(values, { abortEarly: false });\r\n        console.log(\"after\", values)\r\n        status.error = [...status.error, ...(v.error ? v.error?.details.filter((v) => msgKeys.includes(v.context.key)) : [])];\r\n        status.warning = [...status.warning, ...(v.warning ? v.warning?.details.filter((v) => msgKeys.includes(v.context.key)) : [])];\r\n        let fieldValues;\r\n        if (!v.error) {\r\n            fieldValues = updateGlobals({ values, action: \"finish\" });\r\n            /* let mA = fieldValues.formu_materiasprimas_A.map((v) => v.mangueira_A);\r\n            let mBC = fieldValues.formu_materiasprimas_BC.map((v) => v.mangueira_BC); */\r\n\r\n/*             if ((new Set(mA)).size !== mA.length) {\r\n                status.error.push({ message: \"As mangueiras na Extrusora A, não podem estar duplicadas!\" });\r\n            } else if ((new Set(mBC)).size !== mBC.length) {\r\n                status.error.push({ message: \"As mangueiras na Extrusora BC, não podem estar duplicadas!\" });\r\n            } */\r\n\r\n\r\n            let sumA = fieldValues.formu_materiasprimas_A.reduce((a, b) => a + (b[\"arranque_A\"] || 0), 0);\r\n            let sumBC = fieldValues.formu_materiasprimas_BC.reduce((a, b) => a + (b[\"arranque_BC\"] || 0), 0);\r\n\r\n            console.log(\"testeeeee\",Math.round(fieldValues.totalGlobal))\r\n            if (Math.round(fieldValues.totalGlobal) !== 100) {\r\n                status.error.push({ message: \"O Total Global das Matérias Primas tem de ser 100%!\" });\r\n            } else if (sumA !== 100) {\r\n                status.error.push({ message: \"O Total das Matérias Primas da Extrusora A tem de ser 100%!\" });\r\n            }\r\n            else if (sumBC !== 100) {\r\n                status.error.push({ message: \"O Total das Matérias Primas das Extrusoras B&C tem de ser 100%!\" });\r\n            }\r\n        }\r\n\r\n        if (status.error.length === 0 && fieldValues) {\r\n            for (let v of fieldValues?.formu_materiasprimas_A) {\r\n                let matprima_des = matPrimasLookup.find(val => val.ITMREF_0 === v.matprima_cod_A)?.ITMDES1_0;\r\n                items.push({\r\n                    tolerancia: v.tolerancia_A, arranque: v.arranque_A, vglobal: v.global,\r\n                    densidade: v.densidade_A, /* mangueira: v.mangueira_A, */ extrusora: 'A', matprima_cod: v.matprima_cod_A,\r\n                    matprima_des\r\n                });\r\n            }\r\n            for (let v of fieldValues?.formu_materiasprimas_BC) {\r\n                let matprima_des = matPrimasLookup.find(val => val.ITMREF_0 === v.matprima_cod_BC)?.ITMDES1_0;\r\n                items.push({\r\n                    tolerancia: v.tolerancia_BC, arranque: v.arranque_BC, vglobal: v.global,\r\n                    densidade: v.densidade_BC, /* mangueira: v.mangueira_BC, */ extrusora: 'BC', matprima_cod: v.matprima_cod_BC,\r\n                    matprima_des\r\n                });\r\n            }\r\n            const { cliente_cod: { value: cliente_cod, label: cliente_nome } = {} } = values;\r\n            const response = await fetchPost({ url: `${API_URL}/newformulacao/`, parameters: { ...values, items, produto_id: ctx.produto_id, cliente_cod, cliente_nome } });\r\n            if (response.data.status !== \"error\") {\r\n                parentReload({formulacao_id: record.formulacao_id}, \"init\");\r\n            }\r\n            setResultMessage(response.data);\r\n        }\r\n        setFormStatus(status);\r\n    }\r\n\r\n    const onSuccessOK = () => {\r\n        if (operation.key === \"insert\") {\r\n            form.resetFields();\r\n            init();\r\n            setResultMessage({ status: \"none\" });\r\n        }\r\n        setSubmitting(false);\r\n    }\r\n\r\n    const onErrorOK = () => {\r\n        setSubmitting(false);\r\n        setResultMessage({ status: \"none\" });\r\n    }\r\n\r\n    const onClose = (reload = false) => {\r\n        closeParent();\r\n    }\r\n\r\n    const onSubmit = useCallback(() => {\r\n        setSubmitting(true);\r\n        onFinish(form.getFieldsValue(true));\r\n    },[]);\r\n\r\n    return (\r\n        <>\r\n            <ResultMessage\r\n                result={resultMessage}\r\n                successButtonOK={operation.key === \"insert\" && <Button type=\"primary\" key=\"goto-of\" onClick={onSuccessOK}>Criar Nova Formulação</Button>}\r\n                successButtonClose={<Button key=\"goto-close\" onClick={() => onClose(true)}>Fechar</Button>}\r\n                errorButtonOK={<Button type=\"primary\" key=\"goto-ok\" onClick={onErrorOK}>OK</Button>}\r\n                errorButtonClose={<Button key=\"goto-close\" onClick={onClose}>Fechar</Button>}\r\n            >\r\n                <AlertsContainer id=\"el-external\" />\r\n                <AlertMessages formStatus={formStatus} />\r\n                <Form form={form} name={`fps`} onFinish={onFinish} onValuesChange={onValuesChange} component={wrapForm}>\r\n                    <FormLayout\r\n                        id=\"LAY-FORMULACAO-UPSERT\"\r\n                        guides={guides}\r\n                        layout=\"vertical\"\r\n                        style={{ width: \"100%\", padding: \"0px\"/* , minWidth: \"700px\" */ }}\r\n                        schema={schema}\r\n                        field={{\r\n                            forInput,\r\n                            wide: [16],\r\n                            margin: \"2px\", overflow: false, guides: guides,\r\n                            label: { enabled: true, pos: \"top\", align: \"start\", vAlign: \"center\", /* width: \"80px\", */ wrap: false, overflow: false, colon: true, ellipsis: true },\r\n                            alert: { pos: \"right\", tooltip: true, container: false /* container: \"el-external\" */ },\r\n                            layout: { top: \"\", right: \"\", center: \"\", bottom: \"\", left: \"\" },\r\n                            required: true,\r\n                            style: { alignSelf: \"top\" }\r\n                        }}\r\n                        fieldSet={{\r\n                            guides: guides,\r\n                            wide: 16, margin: \"2px\", layout: \"horizontal\", overflow: false\r\n                        }}\r\n                    >\r\n                        {/* {forInput && <>\r\n                            <FieldSet margin={false} field={{ wide: [6, 4] }}>\r\n                                <Field name=\"designacao\" label={{ enabled: false }}><Input placeholder=\"Designação\" size=\"small\" /></Field>\r\n                            </FieldSet>\r\n                            <HorizontalRule margin=\"24px\" />\r\n                        </>\r\n                        } */}\r\n\r\n                        {forInput && <>\r\n                            <FieldSet margin={false} field={{ wide: [6, 8] }}>\r\n                                <Field name=\"designacao\" label={{ enabled: false }}><Input placeholder=\"Designação\" size=\"small\" /></Field>\r\n                                <Field name=\"cliente_cod\" required={false} layout={{ center: \"align-self:center;\", right: \"align-self:center;\" }} label={{ enabled: false, text: \"Cliente\", pos: \"left\" }}>\r\n                                    <SelectDebounceField\r\n                                        placeholder=\"Cliente\"\r\n                                        size=\"small\"\r\n                                        keyField=\"BPCNUM_0\"\r\n                                        textField=\"BPCNAM_0\"\r\n                                        showSearch\r\n                                        showArrow\r\n                                        allowClear\r\n                                        fetchOptions={loadCustomersLookup}\r\n                                    />\r\n                                </Field>\r\n                            </FieldSet>\r\n                            <VerticalSpace height=\"24px\" />\r\n                        </>\r\n                        }\r\n                        {!forInput && <>\r\n                            <FieldSet margin={false} field={{ wide: [9, 7] }}>\r\n                                <Field name=\"cliente_cod\" required={false} layout={{ center: \"align-self:center;\", right: \"align-self:center;\" }} label={{ enabled: false, text: \"Cliente\", pos: \"left\" }}>\r\n                                    <SelectDebounceField\r\n                                        placeholder=\"Cliente\"\r\n                                        size=\"small\"\r\n                                        keyField=\"BPCNUM_0\"\r\n                                        textField=\"BPCNAM_0\"\r\n                                        showSearch\r\n                                        showArrow\r\n                                        allowClear\r\n                                        fetchOptions={loadCustomersLookup}\r\n                                    />\r\n                                </Field>\r\n                            </FieldSet>\r\n                            <VerticalSpace height=\"24px\" />\r\n                        </>\r\n                        }\r\n\r\n                        <FieldSet wide={16} margin={false}>\r\n                            <FieldSet wide={3} />\r\n                            <FieldSet wide={10} margin={false} layout=\"vertical\" field={{ split: 5, wide: undefined }}>\r\n                                <FieldSet margin={false}>\r\n                                    <Field name=\"extr0\" label={{ enabled: false }}><Input disabled={true} size=\"small\" /></Field>\r\n                                    <Field name=\"extr1\" label={{ enabled: false }}><Input disabled={true} size=\"small\" /></Field>\r\n                                    <Field name=\"extr2\" label={{ enabled: false }}><Input disabled={true} size=\"small\" /></Field>\r\n                                    <Field name=\"extr3\" label={{ enabled: false }}><Input disabled={true} size=\"small\" /></Field>\r\n                                    <Field name=\"extr4\" label={{ enabled: false }}><Input disabled={true} size=\"small\" /></Field>\r\n                                </FieldSet>\r\n                                <FieldSet margin={false}>\r\n                                    <Field name=\"extr0_val\" label={{ enabled: false }}><InputNumber disabled={true} size=\"small\" addonAfter={<b>%</b>} maxLength={4} /></Field>\r\n                                    <Field name=\"extr1_val\" label={{ enabled: false }}><InputNumber disabled={true} size=\"small\" addonAfter={<b>%</b>} maxLength={4} /></Field>\r\n                                    <Field name=\"extr2_val\" label={{ enabled: false }}><InputNumber disabled={true} size=\"small\" addonAfter={<b>%</b>} maxLength={4} /></Field>\r\n                                    <Field name=\"extr3_val\" label={{ enabled: false }}><InputNumber disabled={true} size=\"small\" addonAfter={<b>%</b>} maxLength={4} /></Field>\r\n                                    <Field name=\"extr4_val\" label={{ enabled: false }}><InputNumber disabled={true} size=\"small\" addonAfter={<b>%</b>} maxLength={4} /></Field>\r\n                                </FieldSet>\r\n                            </FieldSet>\r\n                            <FieldSet wide={3} />\r\n                        </FieldSet>\r\n\r\n                        <VerticalSpace height=\"12px\" />\r\n\r\n                        <HeaderA />\r\n                        <SubFormMateriasPrimas form={form} name=\"formu_materiasprimas_A\" forInput={forInput} matPrimasLookup={matPrimasLookup} id=\"A\" />\r\n                        <HeaderBC />\r\n                        <SubFormMateriasPrimas form={form} name=\"formu_materiasprimas_BC\" forInput={forInput} matPrimasLookup={matPrimasLookup} sum={true} id=\"BC\" />\r\n\r\n                    </FormLayout>\r\n                </Form>\r\n                {parentRef && <Portal elId={parentRef.current}>\r\n                    <Space>\r\n                        <Button disabled={submitting} onClick={onSubmit} type=\"primary\">Guardar</Button>\r\n                        {/* <Button type=\"primary\" onClick={() => onFinish(form.getFieldsValue(true))}>Guardar</Button> */}\r\n                        {/* <Button onClick={() => setGuides(!guides)}>{guides ? \"No Guides\" : \"Guides\"}</Button> */}\r\n                    </Space>\r\n                </Portal>\r\n                }\r\n            </ResultMessage>\r\n        </>\r\n    );\r\n}","import React, { useEffect, useState, useCallback, useRef, useContext } from 'react';\r\nimport { createUseStyles } from 'react-jss';\r\nimport styled from 'styled-components';\r\nimport dayjs from 'dayjs';\r\nimport Joi from 'joi';\r\nimport { fetch, fetchPost, cancelToken } from \"utils/fetch\";\r\nimport { API_URL } from \"config\";\r\nimport { WrapperForm, TitleForm, FormLayout, Field, FieldSet, Label, LabelField, FieldItem, AlertsContainer, Item, SelectField, InputAddon } from \"components/formLayout\";\r\nimport Toolbar from \"components/toolbar\";\r\nimport { Button, Spin } from \"antd\";\r\nimport { LoadingOutlined, EditOutlined } from '@ant-design/icons';\r\nimport { DATE_FORMAT, DATETIME_FORMAT } from 'config';\r\nimport FormFormulacaoUpsert from '../formulacao/FormFormulacaoUpsert';\r\nimport { OFabricoContext } from './FormOFabricoValidar';\r\n\r\nconst DrawerFormulacao = ({ showWrapper, setShowWrapper, parentReload }) => {\r\n    const [formTitle, setFormTitle] = useState({});\r\n    const iref = useRef();\r\n    const { record = {} } = showWrapper;\r\n    const onVisible = () => {\r\n        setShowWrapper(prev => ({ ...prev, show: !prev.show }));\r\n    }\r\n    return (\r\n        <WrapperForm\r\n            title={<TitleForm title={formTitle.title} subTitle={formTitle.subTitle} />}\r\n            type=\"drawer\"\r\n            destroyOnClose={true}\r\n            //width={width}\r\n            mask={true}\r\n            /* style={{ maginTop: \"48px\" }} */\r\n            setVisible={onVisible}\r\n            visible={showWrapper.show}\r\n            width={800}\r\n            bodyStyle={{ height: \"450px\" /*  paddingBottom: 80 *//* , overflowY: \"auto\", minHeight: \"350px\", maxHeight: \"calc(100vh - 50px)\" */ }}\r\n            footer={<div ref={iref} id=\"form-wrapper\" style={{ textAlign: 'right' }}></div>}\r\n        >\r\n            <FormFormulacaoUpsert setFormTitle={setFormTitle} record={record} parentRef={iref} closeParent={onVisible} parentReload={parentReload} />\r\n        </WrapperForm>\r\n    );\r\n}\r\n\r\nconst loadFormulacaoesLookup = async ({ produto_id, token }) => {\r\n    const { data: { rows } } = await fetchPost({ url: `${API_URL}/formulacoeslookup/`, filter: { produto_id }, sort: [], cancelToken: token });\r\n    return rows;\r\n}\r\nconst getFormulacaoMateriasPrimas = async ({ formulacao_id, token }) => {\r\n    if (!formulacao_id) {\r\n        return [];\r\n    }\r\n    const { data: { rows } } = await fetchPost({ url: `${API_URL}/formulacaomateriasprimasget/`, filter: { formulacao_id }, sort: [], cancelToken: token });\r\n    return rows;\r\n}\r\n\r\nexport default ({ changedValues }) => {\r\n    const { form, guides, schema, fieldStatus, ...ctx } = useContext(OFabricoContext);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showForm, setShowForm] = useState({ show: false });\r\n    const [formulacoes, setFormulacoes] = useState([]);\r\n\r\n    useEffect(() => {\r\n        const cancelFetch = cancelToken();\r\n        loadData({ formulacao_id: form.getFieldValue(\"formulacao_id\"), token: cancelFetch });\r\n        return (() => cancelFetch.cancel(\"Form Formulação Cancelled\"));\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const cancelFetch = cancelToken();\r\n        if (changedValues) {\r\n            if (\"formulacao_id\" in changedValues) {\r\n                setLoading(true);\r\n                loadData({ formulacao_id: changedValues.formulacao_id, token: cancelFetch });\r\n            }\r\n        }\r\n        return (() => cancelFetch.cancel(\"Form Formulação Cancelled\"));\r\n    }, [changedValues]);\r\n\r\n    const loadData = (data = {}, type = \"init\") => {\r\n        const { formulacao_id, token } = data;\r\n        switch (type) {\r\n            case \"lookup\":\r\n                setLoading(true);\r\n                (async () => {\r\n                    setFormulacoes(await loadFormulacaoesLookup({ produto_id: ctx.produto_id, token }));\r\n                    setLoading(false);\r\n                })();\r\n                break;\r\n            default:\r\n                if (!loading) {\r\n                    setLoading(true);\r\n                }\r\n                (async () => {\r\n                    let _formulacoes = formulacoes;\r\n                    if (ctx.produto_id) {\r\n                        _formulacoes = await loadFormulacaoesLookup({ produto_id: ctx.produto_id, token });\r\n                        setFormulacoes(_formulacoes);\r\n                    }\r\n                    if (formulacao_id) {\r\n                        let [formulacao] = _formulacoes.filter(v => v.id === formulacao_id);\r\n                        const formulacaoMateriasPrimas = await getFormulacaoMateriasPrimas({ formulacao_id, token });\r\n                        formulacao = { ...formulacao, cliente_cod: { key: formulacao.cliente_cod, value: formulacao.cliente_cod, label: formulacao.cliente_nome } };\r\n                        form.setFieldsValue({ formulacao, formulacaoMatPrimas: [...formulacaoMateriasPrimas] });\r\n                    }\r\n                    setLoading(false);\r\n                })();\r\n        }\r\n    }\r\n\r\n    const onShowForm = (newForm = false, forInput = false) => {\r\n        if (newForm) {\r\n            setShowForm(prev => ({ ...prev, show: !prev.show, record: {}, forInput }));\r\n        } else {\r\n            setShowForm(prev => ({ ...prev, show: !prev.show, record: { ...form.getFieldsValue([\"formulacao_id\",\"formulacao\", \"formulacaoMatPrimas\"]) }, forInput }));\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Spin spinning={loading} indicator={<LoadingOutlined style={{ fontSize: 24 }} spin />} tip=\"A carregar...\">\r\n                <DrawerFormulacao showWrapper={showForm} setShowWrapper={setShowForm} parentReload={loadData} />\r\n                <FormLayout\r\n                    id=\"LAY-FORMULACAO\"\r\n                    guides={guides}\r\n                    layout=\"vertical\"\r\n                    style={{ width: \"100%\", padding: \"0px\"/* , minWidth: \"700px\" */ }}\r\n                    schema={schema}\r\n                    field={{\r\n                        //wide: [3, 2, 1, '*'],\r\n                        margin: \"2px\", overflow: false, guides: guides,\r\n                        label: { enabled: true, pos: \"top\", align: \"start\", vAlign: \"center\", /* width: \"80px\", */ wrap: false, overflow: false, colon: true, ellipsis: true },\r\n                        alert: { pos: \"right\", tooltip: true, container: true /* container: \"el-external\" */ },\r\n                        layout: { top: \"\", right: \"\", center: \"\", bottom: \"\", left: \"\" },\r\n                        addons: {}, //top|right|center|bottom|left\r\n                        required: true,\r\n                        style: { alignSelf: \"top\" }\r\n                    }}\r\n                    fieldSet={{\r\n                        guides: guides,\r\n                        wide: 16, margin: \"2px\", layout: \"horizontal\", overflow: false\r\n                    }}\r\n                >\r\n                    <FieldSet>\r\n                        <Toolbar\r\n                            style={{ width: \"100%\" }}\r\n                            left={\r\n                                <FieldSet>\r\n                                    <Field name=\"formulacao_id\" layout={{ center: \"align-self:center;\", right: \"align-self:center;\" }} label={{ enabled: true, text: \"Formulacao\", pos: \"left\" }} addons={{\r\n                                        ...(form.getFieldValue(\"formulacao_id\") && { right: <Button onClick={() => onShowForm(false, true)} style={{ marginLeft: \"3px\" }} size=\"small\"><EditOutlined style={{ fontSize: \"16px\" }} /></Button> })\r\n                                    }}>\r\n                                        <SelectField allowClear size=\"small\" data={formulacoes} keyField=\"id\" textField=\"designacao\"\r\n                                            optionsRender={(d, keyField, textField) => ({ label: <div style={{ display: \"flex\" }}><div style={{ minWidth: \"150px\" }}><b>{d[textField]}</b></div><div>v.{d[\"versao\"]}</div></div>, value: d[keyField] })}\r\n                                        />\r\n                                    </Field>\r\n                                </FieldSet>\r\n                            }\r\n                            right={<Button onClick={() => onShowForm(true, true)}>Nova Formulação</Button>}\r\n                        />\r\n                    </FieldSet>\r\n                    <FieldSet>\r\n                        {(!loading && form.getFieldValue(\"formulacao_id\")) && <FormFormulacaoUpsert record={form.getFieldsValue(true)} wrapForm={false} forInput={false} parentReload={loadData} />}\r\n                    </FieldSet>\r\n                </FormLayout>\r\n            </Spin>\r\n        </>\r\n    );\r\n}"],"names":["schema","keys","excludeKeys","getSchema","formu_materiasprimas_A","Joi","label","min","required","formu_materiasprimas_BC","matprima_cod_A","densidade_A","arranque_A","matprima_cod_BC","densidade_BC","arranque_BC","unknown","append","value","suffix","prefix","onUndefined","HeaderA","backgroundColor","color","border","wide","layout","margin","style","fontWeight","textAlign","field","noItemWrap","enabled","borderLeft","alignSelf","display","flexDirection","justifyContent","fontSize","borderTop","HeaderBC","updateGlobals","values","adjust","extrusora","index","action","listA","listBC","rest","ponderacaoA","FORMULACAO_PONDERACAO_EXTR","ponderacaoBC","globalA","globalBC","sumArranqueA","sumArranqueBC","entries","i","v","arranque","global","totalGlobal","SubFormMateriasPrimas","form","forInput","name","matPrimasLookup","sum","id","fields","add","remove","move","map","key","size","data","keyField","textField","optionsRender","d","showSearch","filterOption","input","option","toLowerCase","indexOf","controls","max","precision","step","addonBefore","onClick","idx","fieldValues","getFieldsValue","setFieldsValue","addonAfter","maxLength","getFieldValue","toFixed","fieldName","marginTop","type","FORMULACAO_TOLERANCIA","width","PlusOutlined","LoadMateriasPrimasLookup","record","fetchPost","url","API_URL","filter","rows","loadCustomersLookup","pagination","limit","replaceAll","setFormTitle","parentRef","closeParent","parentReload","wrapForm","ctx","useContext","OFabricoContext","Form","useState","setLoading","submitting","setSubmitting","setChangedValues","error","warning","info","success","formStatus","setFormStatus","guides","formulacao_id","operation","status","resultMessage","setResultMessage","setMatPrimasLookup","init","lookup","title","formulacaoMatPrimas","vglobal","matprima_cod","densidade","tolerancia_A","tolerancia","removeCtrl","tolerancia_BC","formulacao","item_cod","subTitle","item_nome","extr0","FORMULACAO_EXTRUSORAS_COD","extr1","extr2","extr3","extr4","extr0_val","FORMULACAO_EXTRUSORAS_VAL","extr1_val","extr2_val","extr3_val","extr4_val","useEffect","onFinish","items","msgKeys","validate","abortEarly","details","includes","context","sumA","reduce","a","b","sumBC","Math","round","push","message","length","matprima_des","find","val","ITMREF_0","ITMDES1_0","cliente_cod","cliente_nome","parameters","produto_id","response","onClose","onSubmit","useCallback","result","successButtonOK","resetFields","successButtonClose","errorButtonOK","errorButtonClose","onValuesChange","changedValues","allA","allBC","allValues","component","padding","overflow","pos","align","vAlign","wrap","colon","ellipsis","alert","tooltip","container","top","right","center","bottom","left","fieldSet","placeholder","text","showArrow","allowClear","fetchOptions","height","split","undefined","disabled","elId","current","DrawerFormulacao","showWrapper","setShowWrapper","formTitle","iref","useRef","onVisible","prev","show","destroyOnClose","mask","setVisible","visible","bodyStyle","footer","ref","FormFormulacaoUpsert","loadFormulacaoesLookup","token","sort","cancelToken","getFormulacaoMateriasPrimas","fieldStatus","loading","showForm","setShowForm","formulacoes","setFormulacoes","cancelFetch","loadData","cancel","_formulacoes","formulacaoMateriasPrimas","onShowForm","newForm","spinning","indicator","LoadingOutlined","spin","tip","addons","marginLeft","EditOutlined","minWidth"],"sourceRoot":""}