"use strict";(self.webpackChunksgp=self.webpackChunksgp||[]).push([[263],{42263:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});n(88674),n(69070),n(79753),n(82526),n(41817),n(32165),n(78783),n(47042),n(68309),n(91038),n(47941),n(38880),n(89554),n(54747),n(49337),n(33321),n(82772),n(35666),n(57327),n(41539),n(74916),n(15306),n(27207),n(66992),n(33948),n(92222),n(69826),n(21249);var r=n(67294),a=(n(27484),n(42705),n(42919)),l=n(23455),i=n(63386),o=n(28479),c=n(54397),s=n(26402),u=n(5368),m=n(96579),d=n(92080),f=n(71577),p=n(70507),y=n(19650),g=["items"];function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw l}}}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw a}}return l}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t,n,r,a,l,i){try{var o=e[l](i),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function i(e){C(l,r,a,i,o,"next",e)}function o(e){C(l,r,a,i,o,"throw",e)}i(void 0)}))}}var Z=l.Zh.filter((function(e){return!(null!=e&&e.disabled)})),A=function(e,t){return(0,i.J1)({},e,t).unknown(!0)},F=function(){var e=_(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.SD)({url:"".concat(l.T5,"/sellcustomerslookup/"),pagination:{limit:10},filter:O({},"fmulti_customer","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return n=e.sent,r=n.data.rows,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=_(regeneratorRuntime.mark((function e(t){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.produto_id,r=t.token,e.next=3,(0,a.SD)({url:"".concat(l.T5,"/artigosspecslookup/"),filter:{produto_id:n},sort:[],cancelToken:r});case 3:return i=e.sent,o=i.data.rows,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=_(regeneratorRuntime.mark((function e(t){var n,r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.artigospecs_id,r=t.token,n){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,(0,a.SD)({url:"".concat(l.T5,"/artigospecsitemsget/"),filter:{artigospecs_id:n},sort:[],cancelToken:r});case 5:return i=e.sent,o=i.data.rows,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const R=function(e){var t,n=e.record,i=e.setFormTitle,h=e.parentRef,x=e.closeParent,S=(e.parentReload,e.wrapForm),O=void 0===S?"form":S,C=e.forInput,R=void 0===C||C,T=k(d.Z.useForm(),1)[0],N=k((0,r.useState)(!0),2),D=(N[0],N[1]),I=k((0,r.useState)(!1),2),B=I[0],M=I[1],z=k((0,r.useState)({}),2),W=(z[0],z[1]),V=k((0,r.useState)({error:[],warning:[],info:[],success:[]}),2),q=V[0],L=V[1],U=k((0,r.useState)(!1),2),K=U[0],J=(U[1],k((0,r.useState)((t=n.artigospecs.id)?{key:"update",values:{id:t}}:{key:"insert",values:{}}),2)),G=J[0],H=(J[1],k((0,r.useState)({status:"none"}),2)),Y=H[0],$=H[1],Q=k((0,r.useState)([]),2),X=(Q[0],Q[1],k((0,r.useState)([]),2)),ee=X[0],te=X[1],ne=function(e){var t,n=e.items,r=e.artigospecs,a={nitems:n.length},l=w(n.entries());try{for(l.s();!(t=l.n()).done;){var i=k(t.value,2),o=i[0],c=i[1];a["key-".concat(o)]=c.item_key,a["des-".concat(o)]=c.item_des,a["nv-".concat(o)]=c.item_nvalues;var s,u=w(("string"==typeof c.item_values?JSON.parse(c.item_values):c.item_values).entries());try{for(u.s();!(s=u.n()).done;){var m=k(s.value,2),d=m[0],f=m[1];a["v".concat(c.item_key,"-").concat(d)]=f}}catch(e){u.e(e)}finally{u.f()}}}catch(e){l.e(e)}finally{l.f()}var p={key:null==r?void 0:r.cliente_cod,value:null==r?void 0:r.cliente_cod,label:null==r?void 0:r.cliente_nome};return E(E(E({},r),a),{},{cliente_cod:p})},re=function(){var e=arguments.length>1?arguments[1]:void 0;_(regeneratorRuntime.mark((function t(){var r,a,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("update"!==G.key){t.next=10;break}return i&&i({title:"Editar Especificações"}),r=n.artigospecs,a=r.items,l=v(r,g),t.t0=te,t.next=7,j({produto_id:l.produto_id,token:e});case 7:t.t1=t.sent,(0,t.t0)(t.t1),T.setFieldsValue(ne({items:a,artigospecs:l}));case 10:D(!1);case 11:case"end":return t.stop()}}),t)})))()};(0,r.useEffect)((function(){var e=(0,a.BO)();return re(!0,e),function(){return e.cancel("Form Specs Cancelled")}}),[]);var ae=function(){var e=_(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M(!0),!("id"in t)){e.next=7;break}return n=ee.find((function(e){return e.id===t.id})),e.next=5,P({artigospecs_id:t.id});case 5:r=e.sent,T.setFieldsValue(ne({items:r,artigospecs:n}));case 7:W(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=_(regeneratorRuntime.mark((function e(t){var r,i,o,c,s,u,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:if(r={error:[],warning:[],info:[],success:[]},A().validate(t,{abortEarly:!1}).error){e.next=25;break}i=!1,e.t0=regeneratorRuntime.keys(t);case 7:if((e.t1=e.t0()).done){e.next=14;break}if(o=e.t1.value,void 0!==t[o]||"cliente_cod"===o||"designacao"===o){e.next=12;break}return i=!0,e.abrupt("break",14);case 12:e.next=7;break;case 14:if(i&&r.error.push({message:"Os items têm de estar preenchidos!"}),0!==r.error.length){e.next=25;break}return c=t.cliente_cod,s=(c=void 0===c?{}:c).value,u=c.label,e.next=21,(0,a.SD)({url:"".concat(l.T5,"/updatecurrentsettings/"),filter:{csid:n.id},parameters:{type:"specs",specs:E(E({},T.getFieldsValue(!0)),{},{produto_id:n.artigospecs.produto_id,cliente_cod:s,cliente_nome:u})}});case 21:if(m=e.sent,$(m.data),"error"===m.data.status){e.next=25;break}throw"TODO RELOAD PARENT";case 25:L(r);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){x()};return r.createElement(r.Fragment,null,r.createElement(s.Z,{result:Y,successButtonOK:"insert"===G.key&&r.createElement(f.Z,{type:"primary",key:"goto-of",onClick:function(){"insert"===G.key&&(T.resetFields(),re(),$({status:"none"}))}},"Criar Novas Especificações"),successButtonClose:r.createElement(f.Z,{key:"goto-close",onClick:function(){return ie(!0)}},"Fechar"),errorButtonOK:r.createElement(f.Z,{type:"primary",key:"goto-ok",onClick:function(){$({status:"none"})}},"OK"),errorButtonClose:r.createElement(f.Z,{key:"goto-close",onClick:ie},"Fechar")},r.createElement(o.NH,{id:"el-external"}),r.createElement(c.Z,{formStatus:q}),r.createElement(d.Z,{form:T,name:"fps",onFinish:le,onValuesChange:ae,component:O},r.createElement(o.lt,{id:"LAY-SPECS-UPSERT",guides:K,layout:"vertical",style:{width:"100%",padding:"0px"},schema:A,field:{forInput:R,wide:[16],margin:"2px",overflow:!1,guides:!1,label:{enabled:!0,pos:"top",align:"start",vAlign:"center",wrap:!1,overflow:!1,colon:!0,ellipsis:!0},alert:{pos:"right",tooltip:!0,container:!1},layout:{top:"",right:"",center:"",bottom:"",left:""},required:!0,style:{alignSelf:"top"}},fieldSet:{guides:!1,wide:16,margin:"2px",layout:"horizontal",overflow:!1}},R&&r.createElement(r.Fragment,null,r.createElement(o.C3,null,r.createElement(m.Z,{style:{width:"100%"},left:r.createElement(o.C3,null,r.createElement(o.gN,{name:"id",layout:{center:"align-self:center;",right:"align-self:center;"},label:{enabled:!1,text:"Especificações",pos:"left"}},r.createElement(o.mg,{size:"small",data:ee,keyField:"id",textField:"designacao",optionsRender:function(e,t,n){return{label:r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{minWidth:"150px"}},r.createElement("b",null,e[n])),r.createElement("div",null,"v.",e.versao)),value:e[t]}}}))),right:r.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.createElement(o.C3,{style:{minWidth:"300px"},margin:!1,field:{wide:[16]}},r.createElement(o.gN,{name:"cliente_cod",required:!1,layout:{center:"align-self:center;",right:"align-self:center;"},label:{enabled:!1,text:"Cliente",pos:"left"}},r.createElement(o.Fb,{placeholder:"Cliente",size:"small",keyField:"BPCNUM_0",textField:"BPCNAM_0",showSearch:!0,showArrow:!0,allowClear:!0,fetchOptions:F}))))})),r.createElement(o.qL,{height:"12px"})),!R&&r.createElement(r.Fragment,null,r.createElement(o.C3,{margin:!1,field:{wide:[16]}},r.createElement(o.gN,{name:"cliente_cod",required:!1,layout:{center:"align-self:center;",right:"align-self:center;"},label:{enabled:!1,text:"Cliente",pos:"left"}},r.createElement(o.Fb,{placeholder:"Cliente",size:"small",keyField:"BPCNUM_0",textField:"BPCNAM_0",showSearch:!0,showArrow:!0,allowClear:!0,fetchOptions:F}))),r.createElement(o.qL,{height:"12px"})),r.createElement(o.C3,{wide:16,margin:!1,layout:"vertical"},r.createElement(o.C3,{margin:!1},r.createElement(o.mZ,{label:{enabled:!1},wide:7}),r.createElement(o.C3,{wide:9,margin:!1,style:{minWidth:"185px"}},r.createElement(o.mZ,{label:{enabled:!1},split:3},r.createElement("div",{style:{textAlign:"center",fontWeight:700}},"TDS")),r.createElement(o.mZ,{label:{enabled:!1},split:50}),r.createElement(o.mZ,{label:{enabled:!1},split:3},r.createElement("div",{style:{textAlign:"center",fontWeight:700}},"Objetivo")))),r.createElement(o.C3,{margin:!1},r.createElement(o.mZ,{label:{enabled:!1},wide:7}),r.createElement(o.C3,{wide:9,margin:!1,style:{minWidth:"185px"}},r.createElement(o.mZ,{label:{enabled:!1},split:6},r.createElement("div",{style:{textAlign:"center"}},"Min.")),r.createElement(o.mZ,{label:{enabled:!1},split:6},r.createElement("div",{style:{textAlign:"center"}},"Máx.")),r.createElement(o.mZ,{label:{enabled:!1},split:50}),r.createElement(o.mZ,{label:{enabled:!1},split:6},r.createElement("div",{style:{textAlign:"center"}},"Min.")),r.createElement(o.mZ,{label:{enabled:!1},split:6},r.createElement("div",{style:{textAlign:"center"}},"Máx.")))),Z.map((function(e,t){return r.createElement(o.C3,{key:"gop-".concat(t),wide:16,field:{wide:[7,9]},margin:!1},r.createElement(o.mZ,{label:{enabled:!1},style:{fontSize:"11px"}},r.createElement("b",null,e.designacao)," (",e.unidade,")"),r.createElement(o.C3,{wide:9,margin:!1,style:E({minWidth:"185px"},!R&&{fontSize:"10px"})},b(Array(T.getFieldValue("nv-".concat(t)))).map((function(t,n){return n%2==0&&0!==n?r.createElement(r.Fragment,{key:"".concat(e.key,"-").concat(n)},r.createElement(o.mZ,{label:{enabled:!1},split:50}),r.createElement(o.gN,{split:6,key:"".concat(e.key,"-").concat(n),name:"v".concat(e.key,"-").concat(n),label:{enabled:!1}},r.createElement(p.Z,{min:e.min,max:e.max,controls:!1,size:"small",precision:null==e?void 0:e.precision}))):r.createElement(o.gN,{split:6,key:"".concat(e.key,"-").concat(n),name:"v".concat(e.key,"-").concat(n),label:{enabled:!1}},r.createElement(p.Z,{min:e.min,max:e.max,controls:!1,size:"small",precision:null==e?void 0:e.precision}))}))))}))))),h&&r.createElement(u.Z,{elId:h.current},r.createElement(y.Z,null,B&&r.createElement(f.Z,{type:"primary",onClick:function(){return le(T.getFieldsValue(!0))}},"Guardar"),r.createElement(f.Z,{onClick:ie},"Fechar")))))}}}]);
//# sourceMappingURL=03e09c4c925df6e22b1c.chunk.js.map