"use strict";(self.webpackChunksgp=self.webpackChunksgp||[]).push([[90],{19090:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Z});r(88674),r(79753),r(82526),r(41817),r(32165),r(78783),r(47042),r(68309),r(91038),r(74916),r(69070),r(47941),r(38880),r(89554),r(54747),r(49337),r(33321),r(82772),r(35666),r(57327),r(41539),r(66992),r(33948),r(92222),r(69826),r(21249);var n=r(67294),a=(r(27484),r(42705),r(42919)),o=r(23455),i=r(63386),u=r(28479),l=r(54397),c=(r(96641),r(26402)),s=r(96579),f=r(5368),m=r(92080),p=r(71577),d=r(70507),y=r(19650),g=["items"];function v(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw o}}}}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw a}}return o}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t,r,n,a,o,i){try{var u=e[o](i),l=u.value}catch(e){return void r(e)}u.done?t(l):Promise.resolve(l).then(n,a)}function A(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){j(o,n,a,i,u,"next",e)}function u(e){j(o,n,a,i,u,"throw",e)}i(void 0)}))}}var R=o.KR.filter((function(e){return!(null!=e&&e.disabled)})),C=function(e,t){return(0,i.J1)({},e,t).unknown(!0)},P=function(){var e=A(regeneratorRuntime.mark((function e(t){var r,n,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.produto_id,n=t.token,e.next=3,(0,a.SD)({url:"".concat(o.T5,"/gamasoperatoriaslookup/"),filter:{produto_id:r},sort:[],cancelToken:n});case 3:return i=e.sent,u=i.data.rows,e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=A(regeneratorRuntime.mark((function e(t){var r,n,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.gamaoperatoria_id,n=t.token,r){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,(0,a.SD)({url:"".concat(o.T5,"/gamaoperatoriaitemsget/"),filter:{gamaoperatoria_id:r},sort:[],cancelToken:n});case 5:return i=e.sent,u=i.data.rows,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const Z=function(e){var t,r=e.record,i=e.setFormTitle,h=e.parentRef,w=e.closeParent,x=(e.parentReload,e.wrapForm),S=void 0===x?"form":x,j=e.forInput,Z=void 0===j||j,_=O(m.Z.useForm(),1)[0],T=O((0,n.useState)(!0),2),I=(T[0],T[1]),D=O((0,n.useState)({}),2),G=(D[0],D[1]),N=O((0,n.useState)(!1),2),B=N[0],z=N[1],V=O((0,n.useState)({error:[],warning:[],info:[],success:[]}),2),K=V[0],J=V[1],L=O((0,n.useState)(!1),2),M=L[0],U=(L[1],O((0,n.useState)((t=r.gamaoperatoria.id)?{key:"update",values:{id:t}}:{key:"insert",values:{}}),2)),W=U[0],q=(U[1],O((0,n.useState)({status:"none"}),2)),H=q[0],Y=q[1],$=O((0,n.useState)([]),2),Q=$[0],X=$[1],ee=function(e){var t,r=e.items,n=e.gamaoperatoria,a={nitems:r.length},o=E(r.entries());try{for(o.s();!(t=o.n()).done;){var i=O(t.value,2),u=i[0],l=i[1];a["key-".concat(u)]=l.item_key,a["des-".concat(u)]=l.item_des,a["tolerancia-".concat(u)]=l.tolerancia;var c,s=E(("string"==typeof l.item_values?JSON.parse(l.item_values):l.item_values).entries());try{for(s.s();!(c=s.n()).done;){var f=O(c.value,2),m=f[0],p=f[1];a["v".concat(l.item_key,"-").concat(m)]=p}}catch(e){s.e(e)}finally{s.f()}}}catch(e){o.e(e)}finally{o.f()}return k(k({},n),a)},te=function(){var e=arguments.length>1?arguments[1]:void 0;A(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("update"!==W.key){t.next=10;break}return i&&i({title:"Gama Operatória"}),n=r.gamaoperatoria,a=n.items,o=b(n,g),t.t0=X,t.next=7,P({produto_id:o.produto_id,token:e});case 7:t.t1=t.sent,(0,t.t0)(t.t1),_.setFieldsValue(ee({items:a,gamaoperatoria:o}));case 10:I(!1);case 11:case"end":return t.stop()}}),t)})))()};(0,n.useEffect)((function(){var e=(0,a.BO)();return te(!0,e),function(){return e.cancel("Form Gama Operatória Cancelled")}}),[]);var re=function(){var e=A(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(!0),!("id"in t)){e.next=7;break}return r=Q.find((function(e){return e.id===t.id})),e.next=5,F({gamaoperatoria_id:t.id});case 5:n=e.sent,_.setFieldsValue(ee({items:n,gamaoperatoria:r}));case 7:G(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=A(regeneratorRuntime.mark((function e(t){var n,i,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:if(n={error:[],warning:[],info:[],success:[]},C().validate(t,{abortEarly:!1}).error){e.next=22;break}i=!1,e.t0=regeneratorRuntime.keys(t);case 7:if((e.t1=e.t0()).done){e.next=14;break}if("designacao"===(u=e.t1.value)||void 0!==t[u]){e.next=12;break}return i=!0,e.abrupt("break",14);case 12:e.next=7;break;case 14:if(i&&n.error.push({message:"Os items da Gama Operatória têm de estar preenchidos!"}),0!==n.error.length){e.next=22;break}return e.next=18,(0,a.SD)({url:"".concat(o.T5,"/updatecurrentsettings/"),filter:{csid:r.id},parameters:{type:"gamaoperatoria",gamaoperatoria:k(k({},_.getFieldsValue(!0)),{},{produto_id:r.gamaoperatoria.produto_id})}});case 18:if(l=e.sent,Y(l.data),"error"===l.data.status){e.next=22;break}throw"TODO RELOAD PARENT";case 22:J(n);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){w()};return n.createElement(n.Fragment,null,n.createElement(c.Z,{result:H,successButtonOK:"insert"===W.key&&n.createElement(p.Z,{type:"primary",key:"goto-of",onClick:function(){"insert"===W.key&&(_.resetFields(),te(),Y({status:"none"}))}},"Criar Nova Gama Operatória"),successButtonClose:n.createElement(p.Z,{key:"goto-close",onClick:function(){return ae(!0)}},"Fechar"),errorButtonOK:n.createElement(p.Z,{type:"primary",key:"goto-ok",onClick:function(){Y({status:"none"})}},"OK"),errorButtonClose:n.createElement(p.Z,{key:"goto-close",onClick:ae},"Fechar")},n.createElement(u.NH,{id:"el-external"}),n.createElement(l.Z,{formStatus:K}),n.createElement(m.Z,{form:_,name:"fps",onFinish:ne,onValuesChange:re,component:S},n.createElement(u.lt,{id:"LAY-GAMAOPERATORIA-UPSERT",guides:M,layout:"vertical",style:{width:"100%",padding:"0px"},schema:C,field:{forInput:Z,wide:[16],margin:"2px",overflow:!1,guides:M,label:{enabled:!0,pos:"top",align:"start",vAlign:"center",wrap:!1,overflow:!1,colon:!0,ellipsis:!0},alert:{pos:"right",tooltip:!0,container:!1},layout:{top:"",right:"",center:"",bottom:"",left:""},required:!0,style:{alignSelf:"top"}},fieldSet:{guides:M,wide:16,margin:"2px",layout:"horizontal",overflow:!1}},Z&&n.createElement(u.C3,{wide:16},n.createElement(s.Z,{style:{width:"100%"},left:n.createElement(u.C3,null,n.createElement(u.gN,{name:"id",layout:{center:"align-self:center;",right:"align-self:center;"},label:{enabled:!1,text:"Gama Operatória",pos:"left"}},n.createElement(u.mg,{size:"small",data:Q,keyField:"id",textField:"designacao",optionsRender:function(e,t,r){return{label:n.createElement("div",{style:{display:"flex"}},n.createElement("div",{style:{minWidth:"150px"}},n.createElement("b",null,e[r])),n.createElement("div",null,"v.",e.versao)),value:e[t]}}})))})),n.createElement(u.C3,{wide:16,margin:!1,layout:"vertical"},R.map((function(e,t){return n.createElement(u.C3,{key:"gop-".concat(t),wide:16,field:{wide:[5,9,2]},margin:!1},n.createElement(u.mZ,{label:{enabled:!1},style:{fontSize:"11px"}},n.createElement("b",null,e.designacao)," (",e.unidade,")"),n.createElement(u.C3,{wide:9,margin:!1},v(Array(e.nvalues)).map((function(t,r){return n.createElement(u.gN,{split:9,key:"".concat(e.key,"-").concat(r),name:"v".concat(e.key,"-").concat(r),label:{enabled:!1}},n.createElement(d.Z,{min:e.min,max:e.max,controls:!1,size:"small",precision:null==e?void 0:e.precision}))}))),n.createElement(u.gN,{name:"tolerancia-".concat(t),label:{enabled:!1}},n.createElement(d.Z,{style:{maxWidth:"70px"},addonBefore:"±",min:0,max:100,controls:!1,size:"small"})))}))))),h&&n.createElement(f.Z,{elId:h.current},n.createElement(y.Z,null,B&&n.createElement(p.Z,{type:"primary",onClick:function(){return ne(_.getFieldsValue(!0))}},"Guardar"),n.createElement(p.Z,{onClick:ae},"Fechar")))))}}}]);
//# sourceMappingURL=dbbdf212c077e955df97.chunk.js.map