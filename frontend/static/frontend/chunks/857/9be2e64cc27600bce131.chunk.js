"use strict";(self.webpackChunksgp=self.webpackChunksgp||[]).push([[857],{45857:(e,t,r)=>{r.r(t),r.d(t,{default:()=>oe});r(47941),r(82526),r(38880),r(89554),r(54747),r(49337),r(33321),r(47042),r(43371),r(79753),r(41817),r(32165),r(66992),r(78783),r(33948),r(68309),r(91038),r(88674),r(19601),r(35666),r(74916),r(15306),r(27207),r(92222),r(34553),r(26699),r(32023),r(57327),r(41539),r(69070);var n,l=r(67294),a=r(34144),o=r(27484),i=r.n(o),c=r(42705),u=r.n(c),d=r(42919),s=r(23455),f=r(84636),m=r(63386),p=r(10438),E=r(58043),b=r(16403),h=r(96579),v=r(5368),y=r(7171),S=r(55902),g=r(2306),w=r(42239),_=r(71577),D=r(60881),F=r(19650),O=r(12028),x=r(60816),A=r(16114),P=r(92080),T=r(60331),N=r(89366),C=r(76570),M=r(57254),I=r(8812),R=r(78338),Z=r(25592),U=r(15873);function k(){return k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k.apply(this,arguments)}function L(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t,r,n,l,a,o){try{var i=e[a](o),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,l)}function z(e){return function(){var t=this,r=arguments;return new Promise((function(n,l){var a=e.apply(t,r);function o(e){j(a,n,l,o,i,"next",e)}function i(e){j(a,n,l,o,i,"throw",e)}o(void 0)}))}}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,l,a=[],o=!0,i=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(e){i=!0,l=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw l}}return a}(e,t)||V(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){if(e){if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}w.Z.Option;var G,Y,J=_.Z.Group,$=D.Z.Title,q=function(e){var t=e.form,r=e.dataAPI,n=e.groupByOrder,a=e.setGroupByOrder,o=e.setFlyoutStatus,i=e.flyoutStatus,c=e.ordemFabricoStatusField,u=l.createElement(l.Fragment,null,l.createElement(_.Z,{type:"primary",size:"small",disabled:!!i.visible,onClick:function(){return o((function(e){return W(W({},e),{},{visible:!e.visible})}))}},"Nova Ordem de Fabrico")),d=l.createElement(F.Z,null,l.createElement("div",{style:{display:"flex",flexDirection:"row",whiteSpace:"nowrap"}},l.createElement("div",null,"Agrupar por Encomenda: "),l.createElement("div",null,l.createElement(O.Z,{size:"small",checked:n,onClick:function(){r.clearSort(),r.addParameters({groupByOrder:!n}),r.first(),r.fetchPost(),r.clearData(),a((function(e){return!e}))}}))),l.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap"}},l.createElement("div",null,"Ordem de Fabrico: Estado "),l.createElement("div",null,l.createElement(E.ZP,{noStyle:!0,visible:!0,form:t},l.createElement(E.gN,{noStyle:!0,name:"ofstatus",initialValue:"all",noLabel:!0},c())))));return l.createElement(h.Z,{left:u,right:d})},X=l.createElement(x.Z,null,l.createElement(x.Z.Item,{key:"1",icon:l.createElement(N.Z,null)},"1st menu item")),ee=a.ZP.div(n||(G=["\n    padding: 20px 80px; \n    background: #f0f0f0;\n    \n    .connector{\n        position: absolute;\n        top: -10px;\n        left: 60px;\n        height: 60px;\n        z-index: 999;\n        border-left: 2px dotted #8c8c8c;\n        border-bottom: 2px dotted #8c8c8c;\n        width: 25px;\n    }\n"],Y||(Y=G.slice(0)),n=Object.freeze(Object.defineProperties(G,{raw:{value:Object.freeze(Y)}})))),te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.form,r=e.dataAPI,n=e.setShowFilter,a=e.showFilter,o=e.ordemFabricoStatusField,i=(0,l.useState)({}),c=H(i,2),u=(c[0],c[1],(0,l.useState)(!1)),f=H(u,2),m=f[0],b=f[1],h=function(){var e=z(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.SD)({url:"".concat(s.T5,"/sellcustomerslookup/"),pagination:{limit:10},filter:Q({},"fmulti_customer","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return r=e.sent,n=r.data.rows,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=z(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.SD)({url:"".concat(s.T5,"/sellorderslookup/"),pagination:{limit:10},filter:Q({},"fmulti_order","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return r=e.sent,n=r.data.rows,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=z(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.SD)({url:"".concat(s.T5,"/sellitemslookup/"),pagination:{limit:10},filter:Q({},"fmulti_item","%".concat(t.replaceAll(" ","%%"),"%"))});case 2:return r=e.sent,n=r.data.rows,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){return l.createElement(E.K1,{onChange:function(e,t){},handleSearch:v,keyField:"SOHNUM_0",valueField:"SOHNUM_0",labelField:function(e,t,r){return"".concat(e[r],"  -  ").concat(e.PRFNUM_0)},dropdownMatchSelectWidth:350,placeholder:"Nº Encomenda/Nº Proforma",allowClear:!0})},w=function(){return l.createElement(E.K1,{onChange:function(e,t){},handleSearch:h,keyField:"BPCNUM_0",valueField:"BPCNAM_0",labelField:function(e,t,r){return"".concat(e[r],"  -  ").concat(e[t])},dropdownMatchSelectWidth:350,placeholder:"Nº/Nome Cliente",allowClear:!0})},D=function(){return l.createElement(E.K1,{onChange:function(e,t){},handleSearch:S,keyField:"ITMREF_0",valueField:"ITMDES1_0",labelField:function(e,t,r){return"".concat(e[r],"  -  ").concat(e[t])},dropdownMatchSelectWidth:350,placeholder:"Cód/Designação Artigo",allowClear:!0})},F=function(e,t){var n,l;if("filter"===e){!m&&b(!0);var a=W(W({},t),{},{fmulti_customer:t.fmulti_customer&&""!==t.fmulti_customer.value?"%".concat(t.fmulti_customer.value.replaceAll(" ","%%"),"%"):void 0,fmulti_order:t.fmulti_order&&""!==t.fmulti_order.value?"%".concat(t.fmulti_order.value.replaceAll(" ","%%"),"%"):void 0,fmulti_item:t.fmulti_item&&""!==t.fmulti_item.value?"%".concat(t.fmulti_item.value.replaceAll(" ","%%"),"%"):void 0,LASDLVNUM_0:t.LASDLVNUM_0&&""!==t.LASDLVNUM_0?"%".concat(t.LASDLVNUM_0.replaceAll(" ","%%"),"%"):void 0,forderdate:(0,p.TK)(null===(n=t.forderdate)||void 0===n?void 0:n.formatted),SHIDAT_0:(0,p.TK)(null===(l=t.SHIDAT_0)||void 0===l?void 0:l.formatted)});r.addFilters(a),r.first(),r.fetchPost()}},O=function(e,n,l){if("filter"===e)"ofstatus"in n?(r.addFilters({ofstatus:n.ofstatus},!1),r.first(),r.fetchPost()):t.setFieldsValue(l)};return l.createElement(l.Fragment,null,l.createElement(E.fS,{schema:ne({form:t,ordersField:g,customersField:w,itemsField:D,ordemFabricoStatusField:o}),filterRules:re(),form:t,width:350,setShowFilter:n,showFilter:a}),l.createElement(E.ZP,{visible:!0,form:t,name:"feature-form-1",layout:"horizontal",onFinish:function(e){return F("filter",e)},onValuesChange:function(e,t){return O("filter",e,t)},style:{minWidth:"40vw"},rowGap:"10px",field:{layout:"vertical",gap:"5px",overflow:!1,labelStyle:{align:"left"},alert:{position:"right",visible:!0}},fieldSet:{wide:4,layout:"horizontal",overflow:!1,grow:!1,alert:{position:"bottom",visible:!0}}},l.createElement(E.C3,{wide:5},l.createElement(E.gN,{name:"fmulti_order",initialValue:{key:"",value:"",label:""},noLabel:!0},g())),l.createElement(E.C3,null,l.createElement(E.gN,{name:"fmulti_customer",initialValue:{key:"",value:"",label:""},noLabel:!0},w())),l.createElement(E.C3,{wide:5},l.createElement(E.gN,{name:"forderdate",noLabel:!0},l.createElement(E.P,null))),l.createElement(E.C3,{wide:2,style:{alignItems:"flex-end",justifyContent:"flex-start"}},l.createElement(J,null,l.createElement(_.Z,{style:{padding:"3px"},onClick:function(){return t.submit()}},l.createElement(C.Z,null)),l.createElement(_.Z,{style:{padding:"3px"}},l.createElement(y.Z,{style:{fontSize:"16px",marginTop:"2px"},onClick:function(){return n((function(e){return!e}))}})),l.createElement(A.Z,{overlay:X},l.createElement(_.Z,{style:{padding:"3px"}},l.createElement(M.Z,null)))))))},re=function(e){return(0,m.J1)({fmulti_item:u().string().label("Cód/Designação Artigo")},e).unknown(!0)},ne=function(e){return[{fmulti_order:{label:"Nº Encomenda/Nº Proforma",field:e.ordersField}},{fmulti_customer:{label:"Nº/Nome de Cliente",field:e.customersField}},{forderdate:{label:"Data Encomenda",field:{type:"rangedate"}}},{fmulti_item:{label:"Cód/Designação Artigo",field:e.itemsField,initialValue:{key:"",value:"",label:""}}},{SHIDAT_0:{label:"Data Expedição",field:{type:"rangedate"}}},{LASDLVNUM_0:{label:"Nº Última Expedição"}},{ofstatus:{label:"Ordem de Fabrico: Estado",field:e.ordemFabricoStatusField,ignoreFilterTag:function(e){return"all"===e}}}]},le=function(e){var t=e.record,r=H((0,l.useState)([]),2),n=r[0],a=r[1],o=(0,f.E)({payload:{url:"".concat(s.T5,"/sellorderitemsList/"),pagination:{enabled:!1},filter:{SOHNUM_0:t.SOHNUM_0},sort:[]}}),i=(0,b.B)({dataAPI:o,data:o.getData().rows,uuid:"items",include:{SOHNUM_0:{title:"Nº Encomenda"},ITMREF_0:{title:"Cod. Artigo",optional:!1,width:180},ORIQTY_0:{title:"Quantidade Original",optional:!1,width:180},QTY_0:{title:"Quantidade",optional:!1,width:120},ITMDES1_0:{title:"Designação",optional:!1},TSICOD_2:{title:"Gramagem",optional:!1,width:100},TSICOD_3:{title:"Largura",optional:!1,width:100},SDHNUM_0:{title:"Nº Expedição",optional:!1,width:150}},exclude:["SOHNUM_0"]});return(0,l.useEffect)((function(){o.first(),o.fetchPost()}),[]),l.createElement(l.Fragment,null,o.hasData()&&l.createElement(ee,null,l.createElement("div",{className:"connector"}),l.createElement(b.Z,{header:!1,columnChooser:!1,reload:!0,size:"small",selection:{enabled:!0,rowKey:function(e){return e.ITMREF_0},onSelection:a,multiple:!0,selectedRows:n,setSelectedRows:a},dataAPI:o,columns:i,onFetch:o.fetchPost,scroll:{y:400,scrollToFirstRowOnChange:!0}})))},ae=function(e){return l.createElement(le,{record:e})};const oe=function(){var e=H((0,l.useState)([]),2),t=e[0],r=e[1],n=H((0,l.useState)(!1),2),a=n[0],o=n[1],c=H((0,l.useState)([]),2),u=c[0],d=c[1],m=H(P.Z.useForm(),1)[0],p=H((0,l.useState)(!1),2),h=p[0],y=p[1],w=(0,f.E)({payload:{url:"".concat(s.T5,"/sellorders/"),parameters:{groupByOrder:h},pagination:{enabled:!0,page:1,pageSize:15},filter:{},sort:[{column:"SOHNUM_0",direction:"DESC",order:"descend",table:"enc"}]}}),D=document.getElementById("filter-tags"),F=H((0,l.useState)({visible:!1,fullscreen:!1}),2),O=F[0],x=F[1],A=H((0,l.useState)([]),2),N=A[0],C=A[1],M=(0,l.useRef)();(0,l.useEffect)((function(){w.first(),w.fetchPost()}),[]);var j,z=(0,b.B)({dataAPI:w,data:w.getData().rows,uuid:"sorders",include:W(W(W(W({},(j={table:"itm",idx:0,optional:!1},W({},!h&&{ITMREF_0:W({title:"Cód. Artigo",width:"160px",render:function(e){return l.createElement("b",null,e)},style:{background:"red"}},j),ITMDES1_0:W({title:"Designação Artigo",width:"350px",render:function(e){return l.createElement("div",{style:{width:"340px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"11px"}},e)}},j)}))),function(e){return{SOHNUM_0:W({title:"Nº Encomenda",width:"160px",render:function(e){return l.createElement("b",null,e)}},e),PRFNUM_0:W({title:"Nº Fatura Proforma",width:"160px"},e),ORDDAT_0:W({title:"Data Encomenda",width:"160px",render:function(e){return i()(e).format(s.zT)}},e),BPCNAM_0:W({title:"Nome Cliente",width:"20%",render:function(e){return l.createElement("div",{style:{whiteSpace:"nowrap"}},l.createElement("b",null,e))}},e)}}({table:"enc",idx:1,optional:!1})),function(e){return{BPCORD_0:W({title:"Nº Cliente"},e),SHIDAT_0:W({title:"Data Expedição",visible:!0,render:function(e){return i()(e).format(s.zT)}},e),DEMDLVDAT_0:W({title:"Data Expedição Solicitada",render:function(e){return i()(e).format(s.zT)}},e),CUSORDREF_0:W({title:"Ref. Encomenda Cliente",visible:!0},e),DAYLTI_0:W({title:"Prazo Entrega (Dias)",visible:!0},e),LASDLVDAT_0:W({title:"Data Última Expedição",render:function(e){return i()(e).format(s.zT)}},e),LASDLVNUM_0:W({title:"Nº Última Expedição"},e),LASINVDAT_0:W({title:"Data Última Fatura",render:function(e){return i()(e).format(s.zT)}},e),LASINVNUM_0:W({title:"Nº Última Fatura"},e),DSPTOTQTY_0:W({title:"Quantidade Acumulada"},e),DSPTOTVOL_0:W({title:"Volume Acumulado"},e),DSPTOTWEI_0:W({title:"Peso Acumulado"},e),DSPVOU_0:W({title:"Unidade Volume"},e),DSPWEU_0:W({title:"Unidade Peso"},e),CREUSR_0:W({title:"Operador Criação"},e),CREDAT_0:W({title:"Data Criação",render:function(e){return i()(e).format(s.zT)}},e),CREDATTIM_0:W({title:"Data/Hora Criação",render:function(e){return i()(e).format(s.Cu)}},e),UPDUSR_0:W({title:"Operador Modificação"},e),UPDDAT_0:W({title:"Data Modificação",render:function(e){return i()(e).format(s.zT)}},e),UPDDATTIM_0:W({title:"Data/Hora Modificação",render:function(e){return i()(e).format(s.Cu)}},e)}}({table:"enc"})),{},{ACTION:{width:"40px",title:"",sort:!1,optional:!1,idx:999,render:function(e,t){return l.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},!V(t)&&O.visible&&l.createElement(_.Z,{style:{marginRight:"8px"},size:"small",icon:l.createElement(I.Z,null),onClick:function(){return B(t)}}),0===t.status&&l.createElement(T.Z,{icon:l.createElement(R.Z,null),color:"default"}),1===t.status&&l.createElement(T.Z,{icon:l.createElement(Z.Z,{spin:!0}),color:"processing"}),99===t.status&&l.createElement(T.Z,{icon:l.createElement(U.Z,null),color:"success"}))}}}),exclude:[]}),V=function(e){return!(!e.ordemfabrico_id&&-1===N.findIndex((function(t){return t.SOHNUM_0==e.SOHNUM_0&&t.ITMREF_0==e.ITMREF_0})))},B=function(e){V(e)||C((function(t){return[].concat(L(t),[W({},e)])}))},K=function(){return l.createElement(E.mg,{keyField:"value",valueField:"label",style:{width:150},options:[{value:"all",label:"Todos"},{value:"notcreated",label:"Não Criada"},{value:"inpreparation",label:"Em Preparação"},{value:"inprogress",label:"Em Progresso"},{value:"finished",label:"Finalizada"}]})};return l.createElement(l.Fragment,null,l.createElement(S.Z,{flyoutWidth:"700px",flyoutStatus:O,style:{height:"100vh"}},l.createElement(S.Z.content,null,l.createElement(q,{form:m,dataAPI:w,groupByOrder:h,setGroupByOrder:y,setFlyoutStatus:x,flyoutStatus:O,ordemFabricoStatusField:K}),D&&l.createElement(v.Z,{elId:D},l.createElement(E.WH,{form:m,filters:w.getAllFilter(),schema:ne,rules:re()})),l.createElement(b.Z,k({title:l.createElement($,{level:4},"Encomendas"),columnChooser:!0,reload:!0,size:"small",toolbar:l.createElement(te,{form:m,dataAPI:w,setShowFilter:o,showFilter:a,ordemFabricoStatusField:K}),selection:{enabled:!1,rowKey:function(e){return h?e.SOHNUM_0:"".concat(e.SOHNUM_0,"-").concat(e.ITMREF_0,"-").concat(e.SOPLIN_0)},onSelection:r,multiple:!0,selectedRows:t,setSelectedRows:r}},h&&{expandable:{expandedRowRender:ae},onExpand:function(e,t){return function(e,t){d(e?[t]:[])}(e,t.SOHNUM_0)},expandedRowKeys:u},{paginationProps:{pageSizeOptions:[10,15,20,30]},dataAPI:w,columns:z,onFetch:w.fetchPost}))),l.createElement(S.Z.flyout,null,l.createElement(g.Z.Header,{fullScreen:!1,setStatus:x,left:l.createElement($,{level:4,style:{marginBottom:"0px"}},"Nova Ordem de Fabrico")}),l.createElement(g.Z.Body,null,l.createElement(FormOrdemFabricoArtigos,{dataSource:N,setDataSource:C,footerRef:M,closeParent:function(){x((function(e){return W(W({},e),{},{visible:!1})}))},reloadDataTable:w.fetchPost})))))}}}]);
//# sourceMappingURL=9be2e64cc27600bce131.chunk.js.map